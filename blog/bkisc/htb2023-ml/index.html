<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.79e51de7c4464db8eb07f9e30f7461b3.css><link rel=stylesheet href=/css/libs/chroma/igor.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="BKISC"><meta name=description content="An in-depth writeup on Cyber Apocalypse 2023 - The Cursed Mission, Machine Learning category."><link rel=alternate hreflang=en-us href=https://blog.bkisc.com/blog/bkisc/htb2023-ml/><link rel=canonical href=https://blog.bkisc.com/blog/bkisc/htb2023-ml/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu606891fec664e3336fdbe668a4668404_488824_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu606891fec664e3336fdbe668a4668404_488824_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@bkisc"><meta property="twitter:creator" content="@bkisc"><meta property="twitter:image" content="https://blog.bkisc.com/blog/bkisc/htb2023-ml/featured.jpg"><meta property="og:site_name" content="BKISC Blogs"><meta property="og:url" content="https://blog.bkisc.com/blog/bkisc/htb2023-ml/"><meta property="og:title" content="Cyber Apocalypse 2023: The Cursed Mission - Machine Learning | BKISC Blogs"><meta property="og:description" content="An in-depth writeup on Cyber Apocalypse 2023 - The Cursed Mission, Machine Learning category."><meta property="og:image" content="https://blog.bkisc.com/blog/bkisc/htb2023-ml/featured.jpg"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-03-27T01:00:00+00:00"><meta property="article:modified_time" content="2023-03-27T00:00:00+00:00"><title>Cyber Apocalypse 2023: The Cursed Mission - Machine Learning | BKISC Blogs</title><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","flag"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=d676d190107cd280d7490463c331b9fb><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo_huc55a0313517dd04bda48a4ace4db28bc_511389_0x70_resize_lanczos_3.png alt="BKISC Blogs"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo_huc55a0313517dd04bda48a4ace4db28bc_511389_0x70_resize_lanczos_3.png alt="BKISC Blogs"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/introduction><span>Introduction</span></a></li><li class=nav-item><a class=nav-link href=/post><span>News</span></a></li><li class=nav-item><a class=nav-link href=/event><span>Events</span></a></li><li class=nav-item><a class="nav-link active" href=/blog><span>Blogs</span></a></li><li class=nav-item><a class=nav-link href=/members><span>Members</span></a></li><li class=nav-item><a class=nav-link href=/contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Cyber Apocalypse 2023: The Cursed Mission - Machine Learning</h1><div class=article-metadata><div><span><a href=/author/baodoktah/>BaoDoktah</a></span></div><span class=article-date>Mar 27, 2023</span></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:406px><div style=position:relative><img src=/blog/bkisc/htb2023-ml/featured_hu4c2f3180282a9c007fb72f176a24e616_189327_720x2500_fit_q75_h2_lanczos.webp width=720 height=406 alt class=featured-image>
<span class=article-header-caption>Image credit: <a href=https://www.hackthebox.com/ target=_blank rel=noopener><strong>HTB</strong></a></span></div></div><div class=article-container><div class=article-style><p><ul class=tags-list><a href=https://blog.bkisc.com/tag/ctf/>ctf</a>
<a href=https://blog.bkisc.com/tag/writeup/>writeup</a>
<a href=https://blog.bkisc.com/tag/htb-2023/>htb-2023</a></ul><details class="toc-inpage d-print-none" open><summary class=font-weight-bold>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#reconfiguration>Reconfiguration</a></li><li><a href=#mysterious-learnings>Mysterious Learnings</a></li><li><a href=#last-hope>Last Hope</a></li><li><a href=#on-the-rescue>On The Rescue</a></li></ul></nav></details></p><h2 id=reconfiguration>Reconfiguration</h2><ul><li><p><strong>Given zip:</strong> <a href="https://drive.google.com/drive/folders/1Pao4nTUNcvjCksDgyRCFPk_UCYpHeDqw?usp=sharing" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> As Pandora set out on her quest to find the ancient alien relic, she knew that the journey would be treacherous. The desert was vast and unforgiving, and the harsh conditions would put her cyborg body to the test. Pandora started by collecting data about the temperature and humidity levels in the desert. She used a scatter plot in an Orange Workspace file to visualize this data and identified the areas where the temperature was highest and the humidity was lowest. Using this information, she reconfigured her sensors to better withstand the extreme heat and conserve water. But, a second look at the data revealed something otherwordly, it seems that the relic&rsquo;s presence beneath the surface has scarred the land in a very peculiar way, can you see it?</p></li><li><p><strong>Category:</strong> Machine Learning</p></li></ul><p>In this challenge, we embarked on a quest to find an ancient alien relic hidden beneath the desert, following the footsteps of the cyborg Pandora. The task involved analyzing temperature and humidity data and uncovering peculiar patterns that hinted at the relic&rsquo;s presence.</p><p>To begin the analysis, we downloaded and installed the <strong>Orange</strong> data mining tool, which is an open-source data visualization and analysis tool for data scientists. You can download it here: <a href=https://orange.biolab.si/download/ target=_blank rel=noopener>https://orange.biolab.si/download/</a></p><p>After installing <strong>Orange</strong>, we opened the tool and loaded the <strong>analysis.ows</strong> file. We then imported the <strong>point.csv</strong> file into the Orange workspace by adding the &ldquo;File&rdquo; widget and selecting the <strong>point.csv</strong> file from our computer. Next, we created a scatter plot to visualize the data. We added the &ldquo;Scatter Plot&rdquo; widget from &ldquo;Visualize&rdquo; panel to the workspace and connected it to the &ldquo;File&rdquo; widget.</p><img src=guide.png alt=Guide width=1000><p>By viewing the &ldquo;Scatter Plot&rdquo;, we got the flag:</p><img src=flag.png alt=Guide width=1000><p>Flag is: <strong>HTB{sc4tter_pl0ts_4_th3_w1n}</strong></p><h2 id=mysterious-learnings>Mysterious Learnings</h2><ul><li><p><strong>Given zip:</strong> <a href="https://drive.google.com/drive/folders/15cjTqJqcDseU9niakqU64AqI09QlKFcU?usp=share_link" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> One day the archeologist came across a strange metal plate covered in uncommon hieroglyphics. It looked like blueprints for some kind of alien technology. &ldquo;What kind of magic is this?&rdquo; He studied the plate more closely and was amazed by the advanced technology and incredible engineering they were using at a time like this. This could only lead him in him wanting to learn more&mldr;</p></li><li><p><strong>Category:</strong> Machine Learning</p></li></ul><p>In this challenge, we were given an <strong>H5</strong> file containing a pre-trained machine learning model. Our task was to analyze the model and extract a hidden flag.</p><p><strong>H5</strong> file format, also known as <strong>Hierarchical Data Format (HDF5)</strong>, is a versatile data model that can store large amounts of data efficiently. It is widely used in scientific research and engineering for storing and managing data. The format organizes data hierarchically and enables fast I/O operations.</p><p>To solve this challenge, we first needed to load the model from the H5 file and display its summary. We used <strong>TensorFlow</strong> and <strong>Keras</strong> libraries to achieve this. Here is the Python script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow</span> <span class=kn>import</span> <span class=n>keras</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load the model from the HDF5 file</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>models</span><span class=o>.</span><span class=n>load_model</span><span class=p>(</span><span class=s1>&#39;alien.h5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Display the model&#39;s summary</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>summary</span><span class=p>()</span>
</span></span></code></pre></div><p>We noticed a few strings in the layer names that seemed to be part of the flag. By combining these strings,decoded it from base64 we were able to construct the flag.</p><p>Flag is: <strong>HTB{th3s3_4l13nS_4r3_s00000_b4s1c}</strong></p><h2 id=last-hope>Last Hope</h2><ul><li><p><strong>Given zip:</strong> <a href="https://drive.google.com/drive/folders/19s7BGJ3ixtv732sDWy6VUshNhLRGC3Yn?usp=share_link" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> The quantum data came back and analyzed. DISASTER! Our best scientists all agree: Unfortunately our species and our whole culture are about to be eliminated. Due to abnormal behavior of the black hole&rsquo;s singularity our planet is about to get swallowed. Project &ldquo;ONESHOT&rdquo; is our last hope&mldr;</p></li><li><p><strong>Category:</strong> Machine Learning</p></li></ul><p>In this challenge, we are given a file containing <strong>OpenQASM 2.0</strong> code, which represents a quantum circuit. Our goal is to execute the circuit and extract the flag, which is encoded in the most frequent bitstring resulting from the measurement of the quantum circuit.</p><p>Here&rsquo;s a brief write-up of the steps taken to solve this challenge:</p><ol><li><p>We start by reading the <strong>OpenQASM</strong> code from the file named &lsquo;<strong>quantum_artifact.qasm</strong>&rsquo; and store it as a string.</p></li><li><p>Next, we use <strong>Qiskit</strong>, a <strong>Python</strong> library for quantum computing, to convert the <strong>OpenQASM</strong> code into a <strong>QuantumCircuit</strong> object.</p></li><li><p>We set up a quantum simulator using <strong>Qiskit&rsquo;s Aer</strong> module, which allows us to simulate quantum circuits on classical computers.</p></li><li><p>We transpile the circuit, optimizing it for the simulator.</p></li><li><p>We execute the transpiled circuit on the simulator with <strong>1024</strong> shots, meaning the circuit is run <strong>1024</strong> times, and store the result.</p></li><li><p>From the result, we extract the counts, which is a dictionary containing the frequency of each bitstring.</p></li><li><p>We iterate through the counts and find the most frequent bitstring, which is the binary representation of our flag.</p></li><li><p>We convert the most frequent bitstring to a text string by splitting it into groups of 8 bits (1 byte) and using the int() and chr() functions to convert each byte to its corresponding character.</p></li><li><p>Finally, we print the decoded flag.</p></li></ol><p>The provided script follows these steps and successfully extracts the flag from the given quantum circuit.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>Aer</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OpenQASM 2.0 code</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;quantum_artifact.qasm&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>openqasm_code</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load the OpenQASM code into a Qiskit QuantumCircuit object</span>
</span></span><span class=line><span class=cl><span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=o>.</span><span class=n>from_qasm_str</span><span class=p>(</span><span class=n>openqasm_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set up a quantum simulator</span>
</span></span><span class=line><span class=cl><span class=n>simulator</span> <span class=o>=</span> <span class=n>Aer</span><span class=o>.</span><span class=n>get_backend</span><span class=p>(</span><span class=s1>&#39;qasm_simulator&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Transpile the circuit</span>
</span></span><span class=line><span class=cl><span class=n>transpiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Run the circuit on the simulator</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>transpiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>1024</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get the counts from the result</span>
</span></span><span class=line><span class=cl><span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Find the most frequent bitstring</span>
</span></span><span class=line><span class=cl><span class=n>max_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>most_frequent_bitstring</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>bitstring</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>count</span> <span class=o>&gt;</span> <span class=n>max_count</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>max_count</span> <span class=o>=</span> <span class=n>count</span>
</span></span><span class=line><span class=cl>        <span class=n>most_frequent_bitstring</span> <span class=o>=</span> <span class=n>bitstring</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>binary_str</span><span class=o>=</span><span class=n>most_frequent_bitstring</span>
</span></span><span class=line><span class=cl><span class=n>byte_array</span> <span class=o>=</span> <span class=p>[</span><span class=n>binary_str</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>binary_str</span><span class=p>),</span> <span class=mi>8</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Convert each byte to its corresponding character using the int() and chr() functions</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>byte</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span> <span class=k>for</span> <span class=n>byte</span> <span class=ow>in</span> <span class=n>byte_array</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Flag:&#34;</span><span class=p>,</span> <span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></div><p>Flag is: <strong>HTB{a_gl1mps3_0f_h0p3}</strong></p><h2 id=on-the-rescue>On The Rescue</h2><ul><li><p><strong>Given zip:</strong> <a href="https://drive.google.com/drive/folders/13cI2b3Slewv9u7y8ZCIi4Vjfb-HL4_Ye?usp=share_link" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> The archeologist finally found the ancient vessel. Utilizing the alien technology he managed to breach in the central computational unit and learn the reason behind their visit on Earth millions of years ago. A message appeared. It was all a desperate plan for the survival of their kind.</p></li><li><p><strong>Category:</strong> Machine Learning</p></li></ul><p>The challenge presented a simple <strong>Bigram Language Model</strong>, which is a basic character-level language model that predicts the next character based on the current character. We were given the model&rsquo;s architecture <strong>architecture.py</strong> and a pre-trained model file <strong>bigram_model.pt</strong>. The objective was to generate a text that could help us understand the aliens&rsquo; message.The solve script is provided below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>architecture</span> <span class=kn>import</span> <span class=n>BigramLanguageModel</span><span class=p>,</span> <span class=n>vocab</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>text_to_idx</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>([</span><span class=n>vocab</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>text</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>idx_to_text</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>vocab</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>idx</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_text</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>initial_text</span><span class=p>,</span> <span class=n>length</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>generated_text</span> <span class=o>=</span> <span class=n>initial_text</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>length</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>input_idx</span> <span class=o>=</span> <span class=n>text_to_idx</span><span class=p>(</span><span class=n>generated_text</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>input_idx</span> <span class=o>=</span> <span class=n>input_idx</span><span class=o>.</span><span class=n>unsqueeze</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logits</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>input_idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>next_token_idx</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>logits</span><span class=p>,</span> <span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>generated_text</span> <span class=o>+=</span> <span class=n>vocab</span><span class=p>[</span><span class=n>next_token_idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>generated_text</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load the pretrained model</span>
</span></span><span class=line><span class=cl><span class=n>model_path</span> <span class=o>=</span> <span class=s2>&#34;bigram_model.pt&#34;</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>BigramLanguageModel</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>vocab</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>load_state_dict</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>model_path</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>eval</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>device</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>device</span><span class=p>(</span><span class=s2>&#34;cuda&#34;</span> <span class=k>if</span> <span class=n>torch</span><span class=o>.</span><span class=n>cuda</span><span class=o>.</span><span class=n>is_available</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&#34;cpu&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate text</span>
</span></span><span class=line><span class=cl><span class=n>initial_text</span> <span class=o>=</span> <span class=s2>&#34;A&#34;</span>
</span></span><span class=line><span class=cl><span class=n>length</span> <span class=o>=</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=n>generated_text</span> <span class=o>=</span> <span class=n>generate_text</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>initial_text</span><span class=p>,</span> <span class=n>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>generated_text</span><span class=p>)</span>
</span></span></code></pre></div><p>To solve the challenge, we first created utility functions to convert text to index and index to text. Then, we wrote a function generate_text that takes the model, an initial text, and the desired length of the generated text. The function generates text by iteratively feeding the last character of the generated text to the model and appending the predicted character to the generated text.</p><p>We loaded the pre-trained model and moved it to the appropriate device (GPU or CPU). Finally, we generated text using the generate_text function with an initial text and a specified length, and printed the resulting text.</p><p>Flag is: <strong>HTB{Pr0t3c7_L1fe}</strong></p></div><div class=article-tags><a class="badge badge-light" href=/tag/ctf/>ctf</a>
<a class="badge badge-light" href=/tag/writeup/>writeup</a>
<a class="badge badge-light" href=/tag/machine-learning/>machine learning</a>
<a class="badge badge-light" href=/tag/htb-2023/>htb-2023</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-ml%2F&text=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Machine+Learning" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-ml%2F&t=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Machine+Learning" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Cyber%20Apocalypse%202023%3A%20The%20Cursed%20Mission%20-%20Machine%20Learning&body=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-ml%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-ml%2F&title=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Machine+Learning" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Machine+Learning%20https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-ml%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-ml%2F&title=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Machine+Learning" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=/author/baodoktah/><img class="avatar mr-3 avatar-circle" src=/author/baodoktah/avatar_hu7c697624e6f76a4fa80194c4272ebb3e_1658076_270x270_fill_q75_lanczos_center.jpg alt=BaoDoktah></a><div class=media-body><h5 class=card-title><a href=/author/baodoktah/>BaoDoktah</a></h5><h6 class=card-subtitle>Reversing Engineer</h6><p class=card-text>Reverse Engineer at BKISC, dedicated to finding vulnerabilities and developing countermeasures to protect against cyber attacks.</p><ul class=network-icon aria-hidden=true><li><a href=mailto:kimgiabao3333@gmail.com><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/Baodokutah target=_blank rel=noopener><i class="fab fa-github"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2025 BK Information Security Club</p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.fab8b449b814cc9f95b22fcf2e45f05b.js></script>
<script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.0c1be879804fa6ae06a8f4c131cdbf54.js></script>
<script src=/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script></body></html>