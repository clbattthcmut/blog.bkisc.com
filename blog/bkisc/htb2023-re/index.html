<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.79e51de7c4464db8eb07f9e30f7461b3.css><link rel=stylesheet href=/css/libs/chroma/igor.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="BKISC"><meta name=description content="An in-depth writeup on Cyber Apocalypse 2023 - The Cursed Mission, Reverse Engineering category."><link rel=alternate hreflang=en-us href=https://blog.bkisc.com/blog/bkisc/htb2023-re/><link rel=canonical href=https://blog.bkisc.com/blog/bkisc/htb2023-re/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu606891fec664e3336fdbe668a4668404_488824_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu606891fec664e3336fdbe668a4668404_488824_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@bkisc"><meta property="twitter:creator" content="@bkisc"><meta property="twitter:image" content="https://blog.bkisc.com/blog/bkisc/htb2023-re/featured.jpg"><meta property="og:site_name" content="BKISC Blogs"><meta property="og:url" content="https://blog.bkisc.com/blog/bkisc/htb2023-re/"><meta property="og:title" content="Cyber Apocalypse 2023: The Cursed Mission - Reverse Engineering | BKISC Blogs"><meta property="og:description" content="An in-depth writeup on Cyber Apocalypse 2023 - The Cursed Mission, Reverse Engineering category."><meta property="og:image" content="https://blog.bkisc.com/blog/bkisc/htb2023-re/featured.jpg"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-03-27T01:00:00+00:00"><meta property="article:modified_time" content="2023-03-27T00:00:00+00:00"><title>Cyber Apocalypse 2023: The Cursed Mission - Reverse Engineering | BKISC Blogs</title><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","flag"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=114ab32d7c46799cba1e2d214fc1afd5><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo_huc55a0313517dd04bda48a4ace4db28bc_511389_0x70_resize_lanczos_3.png alt="BKISC Blogs"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo_huc55a0313517dd04bda48a4ace4db28bc_511389_0x70_resize_lanczos_3.png alt="BKISC Blogs"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/introduction><span>Introduction</span></a></li><li class=nav-item><a class=nav-link href=/post><span>News</span></a></li><li class=nav-item><a class=nav-link href=/event><span>Events</span></a></li><li class=nav-item><a class="nav-link active" href=/blog><span>Blogs</span></a></li><li class=nav-item><a class=nav-link href=/members><span>Members</span></a></li><li class=nav-item><a class=nav-link href=/contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Cyber Apocalypse 2023: The Cursed Mission - Reverse Engineering</h1><div class=article-metadata><div><span><a href=/author/fazect/>FazeCT</a></span>, <span><a href=/author/baodoktah/>BaoDoktah</a></span></div><span class=article-date>Mar 27, 2023</span></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:406px><div style=position:relative><img src=/blog/bkisc/htb2023-re/featured_hu4c2f3180282a9c007fb72f176a24e616_189327_720x2500_fit_q75_h2_lanczos.webp width=720 height=406 alt class=featured-image>
<span class=article-header-caption>Image credit: <a href=https://www.hackthebox.com/ target=_blank rel=noopener><strong>HTB</strong></a></span></div></div><div class=article-container><div class=article-style><p><ul class=tags-list><a href=https://blog.bkisc.com/tag/ctf/>ctf</a>
<a href=https://blog.bkisc.com/tag/writeup/>writeup</a>
<a href=https://blog.bkisc.com/tag/re/>re</a>
<a href=https://blog.bkisc.com/tag/htb-2023/>htb-2023</a></ul><details class="toc-inpage d-print-none" open><summary class=font-weight-bold>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#shattered-tablet>Shattered Tablet</a></li><li><a href=#needle-in-a-haystack>Needle in a Haystack</a></li><li><a href=#she-shells-c-shells>She Shells C Shells</a></li><li><a href=#hunting-license>Hunting License</a></li><li><a href=#cave-system>Cave System</a></li><li><a href=#alien-saboteur>Alien Saboteur</a></li><li><a href=#somewhat-linear>Somewhat Linear</a></li><li><a href=#analogue-signal-processing-v2>Analogue Signal Processing v2</a></li><li><a href=#original-posts>Original Posts</a></li></ul></nav></details></p><h2 id=shattered-tablet>Shattered Tablet</h2><ul><li><p><strong>Given file:</strong> <a href="https://drive.google.com/file/d/1KbW9wdpO7sfwq1nUaqMTmmriVMkXzpdq/view?usp=sharing" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> Deep in an ancient tomb, you&rsquo;ve discovered a stone tablet with secret information on the locations of other relics. However, while dodging a poison dart, it slipped from your hands and shattered into hundreds of pieces. Can you reassemble it and read the clues?</p></li><li><p><strong>Category:</strong> Reverse Engineering</p></li><li><p><strong>Difficulty:</strong> Very Easy</p></li></ul><p>Reverse Engineering category greets us with a binary. I used <a href=https://hex-rays.com/ida-pro/ target=_blank rel=noopener>IDA Pro</a> to decompile the binary.</p><p>In the main function, the input is being checked through an if clause.</p><p>I used <a href=https://angr.io/ target=_blank rel=noopener>angr</a> to get the input (you can refer to <a href=https://docs.angr.io/examples target=_blank rel=noopener>this</a> and <a href=https://s0uthwood.github.io/post/angr-ctf-writeup/ target=_blank rel=noopener>this, too</a> to get the hang of angr).</p><p>Here is the Python script.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s1>&#39;E:/Downloads/tablet&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>entry_state</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=mh>0x401359</span><span class=p>,</span> <span class=n>avoid</span><span class=o>=</span><span class=mh>0x401367</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>posix</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span></span></code></pre></div><p>We have to find the address of <strong>puts(&ldquo;Yes! That&rsquo;s right!&rdquo;);</strong> and avoid the address of <strong>puts(&ldquo;No&mldr; not that&rdquo;);</strong>. Also, we have to increase each of the address by <strong>0x400000</strong> due to the fact that this binary is <a href=https://ir0nstone.gitbook.io/notes/types/stack/pie target=_blank rel=noopener>PIE-enabled</a>.</p><p>Flag is: <strong>HTB{br0k3n_4p4rt,n3ver_t0_b3_r3p41r3d}</strong></p><h2 id=needle-in-a-haystack>Needle in a Haystack</h2><ul><li><p><strong>Given file:</strong> <a href="https://drive.google.com/file/d/1f9daRLUAowb2GXMbgTaZWzu8v7aEqkWz/view?usp=sharing" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> You&rsquo;ve obtained an ancient alien Datasphere, containing categorized and sorted recordings of every word in the forgotten intergalactic common language. Hidden within it is the password to a tomb, but the sphere has been worn with age and the search function no longer works, only playing random recordings. You don&rsquo;t have time to search through every recording - can you crack it open and extract the answer?</p></li><li><p><strong>Category:</strong> Reverse Engineering</p></li><li><p><strong>Difficulty:</strong> Very Easy</p></li></ul><p>We are given an another binary. Again, load the binary using <a href=https://hex-rays.com/ida-pro/ target=_blank rel=noopener>IDA Pro</a>.</p><p>This time, the main algorithm of the binary is to print out a random element from the given list, and guess what, the flag is also there!</p><img src=re1.png alt=linux width=1000><p>Flag is: <strong>HTB{d1v1ng_1nt0_th3_d4tab4nk5}</strong></p><h2 id=she-shells-c-shells>She Shells C Shells</h2><ul><li><p><strong>Given file:</strong> <a href="https://drive.google.com/file/d/1oYAAIEwVZ2zmv7vTyZVhfCMPLxoinSKK/view?usp=sharing" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> You&rsquo;ve arrived in the Galactic Archive, sure that a critical clue is hidden here. You wait anxiously for a terminal to boot up, hiding in the shadows from the guards hunting for you. Unfortunately, it looks like you&rsquo;ll need a password to get what you need without setting off the alarms&mldr;</p></li><li><p><strong>Category:</strong> Reverse Engineering</p></li><li><p><strong>Difficulty:</strong> Very Easy</p></li></ul><p>We get another binary, and it&rsquo;s time to use <a href=https://hex-rays.com/ida-pro/ target=_blank rel=noopener>IDA Pro</a> to decompile it.</p><p>Load the binary, we notice the function <strong>func_flag</strong>. Let&rsquo;s check that out!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>fgets</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=mi>256</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=mh>0x4C</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^=</span> <span class=n>m1</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=n>memcmp</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>t</span><span class=p>,</span> <span class=mh>0x4DuLL</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mh>0xFFFFFFFFLL</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=mh>0x4C</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>s</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>^=</span> <span class=n>m2</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>printf</span><span class=p>(</span><span class=s>&#34;Flag: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span></code></pre></div><p>This is the main part of the function. Our input string s will be used to <strong>XOR</strong> with two lists, <strong>m1</strong> and <strong>m2</strong>. We can use <strong>export data</strong> in IDA to dump out the contents of <strong>m1</strong> and <strong>m2</strong>, as shown below (do the same for <strong>m2</strong>).</p><img src=re2.png alt=linux width=1000><p>We also know that after the first <strong>XOR</strong>, <strong>s</strong> needs to be equal to <strong>t</strong> (which we can get from the memory, too). Then we can reverse <strong>XOR</strong> to find <strong>s</strong>, and the algorithm looks like this.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=n>m1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mi>8</span><span class=p>]</span>
</span></span></code></pre></div><p>Since after the check, we continue to <strong>XOR</strong> <strong>m2</strong> with the modified <strong>s</strong> (which should be equal to <strong>t</strong> after the memcmp), we get the algorithm to print out our flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=n>m2</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span></code></pre></div><p>We can use this Python script to get the flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>m2</span> <span class=o>=</span> <span class=p>[</span> <span class=mh>0x64</span><span class=p>,</span> <span class=mh>0x1E</span><span class=p>,</span> <span class=mh>0xF5</span><span class=p>,</span> <span class=mh>0xE2</span><span class=p>,</span> <span class=mh>0xC0</span><span class=p>,</span> <span class=mh>0x97</span><span class=p>,</span> <span class=mh>0x44</span><span class=p>,</span> <span class=mh>0x1B</span><span class=p>,</span> <span class=mh>0xF8</span><span class=p>,</span> <span class=mh>0x5F</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mh>0xF9</span><span class=p>,</span> <span class=mh>0xBE</span><span class=p>,</span> <span class=mh>0x18</span><span class=p>,</span> <span class=mh>0x5D</span><span class=p>,</span> <span class=mh>0x48</span><span class=p>,</span> <span class=mh>0x8E</span><span class=p>,</span> <span class=mh>0x91</span><span class=p>,</span> <span class=mh>0xE4</span><span class=p>,</span> <span class=mh>0xF6</span><span class=p>,</span> <span class=mh>0xF1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mh>0x5C</span><span class=p>,</span> <span class=mh>0x8D</span><span class=p>,</span> <span class=mh>0x26</span><span class=p>,</span> <span class=mh>0x9E</span><span class=p>,</span> <span class=mh>0x2B</span><span class=p>,</span> <span class=mh>0xA1</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0xF7</span><span class=p>,</span> <span class=mh>0xC6</span><span class=p>,</span> <span class=mh>0xF7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mh>0xE4</span><span class=p>,</span> <span class=mh>0xB3</span><span class=p>,</span> <span class=mh>0x98</span><span class=p>,</span> <span class=mh>0xFE</span><span class=p>,</span> <span class=mh>0x57</span><span class=p>,</span> <span class=mh>0xED</span><span class=p>,</span> <span class=mh>0x4A</span><span class=p>,</span> <span class=mh>0x4B</span><span class=p>,</span> <span class=mh>0xD1</span><span class=p>,</span> <span class=mh>0xF6</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mh>0xA1</span><span class=p>,</span> <span class=mh>0xEB</span><span class=p>,</span> <span class=mh>0x09</span><span class=p>,</span> <span class=mh>0xC6</span><span class=p>,</span> <span class=mh>0x99</span><span class=p>,</span> <span class=mh>0xF2</span><span class=p>,</span> <span class=mh>0x58</span><span class=p>,</span> <span class=mh>0xFA</span><span class=p>,</span> <span class=mh>0xCB</span><span class=p>,</span> <span class=mh>0x6F</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mh>0x6F</span><span class=p>,</span> <span class=mh>0x5E</span><span class=p>,</span> <span class=mh>0x1F</span><span class=p>,</span> <span class=mh>0xBE</span><span class=p>,</span> <span class=mh>0x2B</span><span class=p>,</span> <span class=mh>0x13</span><span class=p>,</span> <span class=mh>0x8E</span><span class=p>,</span> <span class=mh>0xA5</span><span class=p>,</span> <span class=mh>0xA9</span><span class=p>,</span> <span class=mh>0x99</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mh>0x93</span><span class=p>,</span> <span class=mh>0xAB</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0x70</span><span class=p>,</span> <span class=mh>0x1C</span><span class=p>,</span> <span class=mh>0xC0</span><span class=p>,</span> <span class=mh>0xC4</span><span class=p>,</span> <span class=mh>0x3E</span><span class=p>,</span> <span class=mh>0xA6</span><span class=p>,</span> <span class=mh>0xFE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mh>0x93</span><span class=p>,</span> <span class=mh>0x35</span><span class=p>,</span> <span class=mh>0x90</span><span class=p>,</span> <span class=mh>0xC3</span><span class=p>,</span> <span class=mh>0xC9</span><span class=p>,</span> <span class=mh>0x10</span><span class=p>,</span> <span class=mh>0xE9</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0x2C</span><span class=p>,</span><span class=mh>0x4A</span><span class=p>,</span><span class=mh>0x0B7</span><span class=p>,</span><span class=mh>0x99</span><span class=p>,</span><span class=mh>0x0A3</span><span class=p>,</span><span class=mh>0x0E5</span><span class=p>,</span><span class=mh>0x70</span><span class=p>,</span><span class=mh>0x78</span><span class=p>,</span><span class=mh>0x93</span><span class=p>,</span><span class=mh>0x6E</span><span class=p>,</span><span class=mh>0x97</span><span class=p>,</span><span class=mh>0x0D9</span><span class=p>,</span><span class=mh>0x47</span><span class=p>,</span><span class=mh>0x6D</span><span class=p>,</span><span class=mh>0x38</span><span class=p>,</span><span class=mh>0x0BD</span><span class=p>,</span><span class=mh>0x0FF</span><span class=p>,</span><span class=mh>0x0BB</span><span class=p>,</span><span class=mh>0x85</span><span class=p>,</span><span class=mh>0x99</span><span class=p>,</span><span class=mh>0x6F</span><span class=p>,</span><span class=mh>0xE1</span><span class=p>,</span><span class=mh>0x4A</span><span class=p>,</span><span class=mh>0x0AB</span><span class=p>,</span><span class=mh>0x74</span><span class=p>,</span><span class=mh>0x0C3</span><span class=p>,</span><span class=mh>0x7B</span><span class=p>,</span><span class=mh>0x0A8</span><span class=p>,</span><span class=mh>0x0B2</span><span class=p>,</span><span class=mh>0x9F</span><span class=p>,</span><span class=mh>0x0D7</span><span class=p>,</span><span class=mh>0x0EC</span><span class=p>,</span><span class=mh>0x0EB</span><span class=p>,</span><span class=mh>0x0CD</span><span class=p>,</span><span class=mh>0x63</span><span class=p>,</span><span class=mh>0x0B2</span><span class=p>,</span><span class=mh>0x39</span><span class=p>,</span><span class=mh>0x23</span><span class=p>,</span><span class=mh>0x0E1</span><span class=p>,</span><span class=mh>0x84</span><span class=p>,</span><span class=mh>0x92</span><span class=p>,</span><span class=mh>0x96</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x0C6</span><span class=p>,</span><span class=mh>0x99</span><span class=p>,</span><span class=mh>0x0F2</span><span class=p>,</span><span class=mh>0x58</span><span class=p>,</span><span class=mh>0x0FA</span><span class=p>,</span><span class=mh>0x0CB</span><span class=p>,</span><span class=mh>0x6F</span><span class=p>,</span><span class=mh>0x6F</span><span class=p>,</span><span class=mh>0x5E</span><span class=p>,</span><span class=mh>0x1F</span><span class=p>,</span><span class=mh>0x0BE</span><span class=p>,</span><span class=mh>0x2B</span><span class=p>,</span><span class=mh>0x13</span><span class=p>,</span><span class=mh>0x8E</span><span class=p>,</span><span class=mh>0x0A5</span><span class=p>,</span><span class=mh>0x0A9</span><span class=p>,</span><span class=mh>0x99</span><span class=p>,</span><span class=mh>0x93</span><span class=p>,</span><span class=mh>0x0AB</span><span class=p>,</span><span class=mh>0x8F</span><span class=p>,</span><span class=mh>0x70</span><span class=p>,</span><span class=mh>0x1C</span><span class=p>,</span><span class=mh>0x0C0</span><span class=p>,</span><span class=mh>0x0C4</span><span class=p>,</span><span class=mh>0x3E</span><span class=p>,</span><span class=mh>0x0A6</span><span class=p>,</span><span class=mh>0x0FE</span><span class=p>,</span><span class=mh>0x93</span><span class=p>,</span><span class=mh>0x35</span><span class=p>,</span><span class=mh>0x90</span><span class=p>,</span><span class=mh>0x0C3</span><span class=p>,</span><span class=mh>0x0C9</span><span class=p>,</span><span class=mh>0x10</span><span class=p>,</span><span class=mh>0x0E9</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=nb>chr</span><span class=p>(</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=n>m2</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span></span></code></pre></div><p>Flag is: <strong>HTB{cr4ck1ng_0p3n_sh3ll5_by_th3_s34_sh0r3}</strong></p><h2 id=hunting-license>Hunting License</h2><ul><li><p><strong>Given file:</strong> <a href="https://drive.google.com/file/d/1xResSHQcRL1wdSw3t3u-TuzGj839Gh0m/view?usp=sharing" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> STOP! Adventurer, have you got an up to date relic hunting license? If you don&rsquo;t, you&rsquo;ll need to take the exam again before you&rsquo;ll be allowed passage into the spacelanes!</p></li><li><p><strong>Note:</strong> This challenge had a docker but it might be closed at the time you are reading this. All needed files will be given in the write-ups.</p></li><li><p><strong>Category:</strong> Reverse Engineering</p></li><li><p><strong>Difficulty:</strong> Easy</p></li></ul><p>We are given a binary file, together with a netcat server.</p><p>By analyzing the binary file using <a href=https://www.geeksforgeeks.org/file-command-in-linux-with-examples/ target=_blank rel=noopener>file</a>, we can answer some first questions.</p><img src=re3.png alt=linux width=1000><p>For the next question, we can use <em><strong>ldd license</strong></em> to get info about libraries of the binary.</p><img src=re4.png alt=linux width=1000><p>For the upcoming question, I used <a href=https://manpages.ubuntu.com/manpages/trusty/man1/gdb.1.html target=_blank rel=noopener>gdb</a> together with its <strong>info function</strong> command to get the address of the <strong>main</strong> function.</p><img src=re5.png alt=linux width=1000>
<img src=re6.png alt=linux width=1000><p>Using <a href=https://hex-rays.com/ida-pro/ target=_blank rel=noopener>IDA Pro</a>, we can answer some more questions correctly.</p><p>There will be 3 passwords for us to find, the first one is too obvious, the second one is reversed, and the last one is generated using <strong>XOR</strong> with the key <strong>19</strong>.</p><p>Here is the script for the last password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0x47</span><span class=p>,</span><span class=mh>0x7B</span><span class=p>,</span><span class=mh>0x7A</span><span class=p>,</span><span class=mh>0x61</span><span class=p>,</span><span class=mh>0x77</span><span class=p>,</span><span class=mh>0x52</span><span class=p>,</span><span class=mh>0x7D</span><span class=p>,</span><span class=mh>0x77</span><span class=p>,</span><span class=mh>0x55</span><span class=p>,</span><span class=mh>0x7A</span><span class=p>,</span><span class=mh>0x7D</span><span class=p>,</span><span class=mh>0x72</span><span class=p>,</span><span class=mh>0x7F</span><span class=p>,</span><span class=mh>0x32</span><span class=p>,</span><span class=mh>0x32</span><span class=p>,</span><span class=mh>0x32</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>i</span> <span class=o>^</span> <span class=n>key</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>data</span><span class=p>))</span>
</span></span></code></pre></div><img src=re7.png alt=linux width=1000><p>Flag is: <strong>HTB{l1c3ns3_4cquir3d-hunt1ng_t1m3!}</strong></p><h2 id=cave-system>Cave System</h2><ul><li><p><strong>Given file:</strong> <a href="https://drive.google.com/file/d/10IGptbNTTSxzx-Mv0Elgt2Vx4bVKjHCZ/view?usp=sharing" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> Deep inside a cave system, 500 feet below the surface, you find yourself stranded with supplies running low. Ahead of you sprawls a network of tunnels, branching off and looping back on themselves. You don&rsquo;t have time to explore them all - you&rsquo;ll need to program your cave-crawling robot to find the way out&mldr;</p></li><li><p><strong>Category:</strong> Reverse Engineering</p></li><li><p><strong>Difficulty:</strong> Easy</p></li></ul><p>We are given a binary once again. Using <a href=https://hex-rays.com/ida-pro/ target=_blank rel=noopener>IDA Pro</a>, for this type of challenge, we should consider using <a href=https://angr.io/ target=_blank rel=noopener>angr</a> or <a href=https://pypi.org/project/z3-solver/ target=_blank rel=noopener>z3 solver</a>. Here I choose to use <a href=https://angr.io/ target=_blank rel=noopener>angr</a></p><p>Here is the Python script.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s1>&#39;E:/Downloads/cave&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>entry_state</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=mh>0x401ABA</span><span class=p>,</span> <span class=n>avoid</span><span class=o>=</span><span class=mh>0x401AC8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>posix</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span></span></code></pre></div><p>We have to find the address of <strong>puts(&ldquo;Freedom at last!&rdquo;);</strong> and avoid the address of <strong>puts(&ldquo;Lost in the darkness, you&rsquo;ll wander for eternity&mldr;&rdquo;);</strong>. Also, we have to increase each of the address by <strong>0x400000</strong> due to the fact that this binary is <a href=https://ir0nstone.gitbook.io/notes/types/stack/pie target=_blank rel=noopener>PIE-enabled</a>.</p><p>Flag is: <strong>HTB{H0p3_u_d1dn&rsquo;t_g3t_th15_by_h4nd,1t5_4_pr3tty_l0ng_fl4g!!!}</strong></p><h2 id=alien-saboteur>Alien Saboteur</h2><ul><li><p><strong>Given file:</strong> <a href="https://drive.google.com/file/d/1LFinP3KsutSSt46WExL_TekEBFv_GOmR/view?usp=sharing" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Description:</strong> You finally manage to make it into the main computer of the vessel, it&rsquo;s time to get this over with. You try to shutdown the vessel, however a couple of access codes unknown to you are needed. You try to figure them out, but the computer start speaking some weird language, it seems like gibberish&mldr;</p></li><li><p><strong>Category:</strong> Reverse Engineering</p></li><li><p><strong>Difficulty:</strong> Medium</p></li></ul><p>We get a binary with a text file with no format. Analyze the binary using <a href=https://hex-rays.com/ida-pro/ target=_blank rel=noopener>IDA Pro</a>, from the function &ldquo;vm_create&rdquo;, the text file is contained in *<strong>(v3 + 18)</strong> and being executed like a normal binary.</p><img src=re8.png alt=linux width=1000><p>Each instructions appear to be at every <strong>6th</strong> index from 0. From that, I wrote an interpreter for the text file (that runs through the binary).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>malduck</span> <span class=kn>import</span> <span class=n>xor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ls</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;vm_add&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_addi&#39;</span><span class=p>,</span><span class=s1>&#39;vm_sub&#39;</span><span class=p>,</span><span class=s1>&#39;vm_subi&#39;</span><span class=p>,</span><span class=s1>&#39;vm_mul&#39;</span><span class=p>,</span><span class=s1>&#39;vm_muli&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_div&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_cmp&#39;</span><span class=p>,</span><span class=s1>&#39;vm_jmp&#39;</span><span class=p>,</span><span class=s1>&#39;vm_inv&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_push&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_pop&#39;</span><span class=p>,</span><span class=s1>&#39;vm_mov&#39;</span><span class=p>,</span><span class=s1>&#39;vm_nop&#39;</span><span class=p>,</span><span class=s1>&#39;vm_exit&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_print&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_putc&#39;</span><span class=p>,</span><span class=s1>&#39;vm_je&#39;</span><span class=p>,</span><span class=s1>&#39;vm_jne&#39;</span><span class=p>,</span><span class=s1>&#39;vm_jle&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_jge&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_xor&#39;</span><span class=p>,</span><span class=s1>&#39;vm_store&#39;</span><span class=p>,</span> <span class=s1>&#39;vm_load&#39;</span><span class=p>,</span><span class=s1>&#39;vm_input&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>disass</span><span class=p>(</span><span class=n>code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>op</span> <span class=o>=</span> <span class=n>code</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>opr</span> <span class=o>=</span> <span class=n>ls</span><span class=p>[</span><span class=n>op</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_add&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: ADD [</span><span class=si>{}</span><span class=s2>] &lt;- [</span><span class=si>{}</span><span class=s2>] + [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_addi&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: ADDI [</span><span class=si>{}</span><span class=s2>] &lt;- [</span><span class=si>{}</span><span class=s2>] + </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_sub&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: SUB [</span><span class=si>{}</span><span class=s2>] &lt;- [</span><span class=si>{}</span><span class=s2>] - [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_subi&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: SUBI [</span><span class=si>{}</span><span class=s2>] &lt;- [</span><span class=si>{}</span><span class=s2>] - </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_mul&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: MUL [</span><span class=si>{}</span><span class=s2>] &lt;- [</span><span class=si>{}</span><span class=s2>] * [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_muli&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: MULI [</span><span class=si>{}</span><span class=s2>] &lt;- [</span><span class=si>{}</span><span class=s2>] * </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_div&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: DIV [</span><span class=si>{}</span><span class=s2>] &lt;- [</span><span class=si>{}</span><span class=s2>] / [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_cmp&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: CMP flag &lt;- [</span><span class=si>{}</span><span class=s2>] == [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_jmp&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: JMP pc &lt;- pc + [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=nb>chr</span><span class=p>(</span><span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_inv&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: INV [31] &lt;- syscall(</span><span class=si>{}</span><span class=s2>, </span><span class=si>{}</span><span class=s2>)&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_push&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: PUSH [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_pop&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: POP [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_mov&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: MOV [</span><span class=si>{}</span><span class=s2>] &lt;- </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_nop&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: NOP&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_exit&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: EXIT&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_print&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: PRINT [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_putc&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: PUTC </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ascii</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_je&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: JE pc &lt;- </span><span class=si>{}</span><span class=s2> if [</span><span class=si>{}</span><span class=s2>] == [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span><span class=o>*</span><span class=mi>6</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_jne&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: JNE pc &lt;- </span><span class=si>{}</span><span class=s2> if [</span><span class=si>{}</span><span class=s2>] != [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span><span class=o>*</span><span class=mi>6</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_jle&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: JLE pc &lt;- </span><span class=si>{}</span><span class=s2> if [</span><span class=si>{}</span><span class=s2>] &lt;= [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span><span class=o>*</span><span class=mi>6</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_jge&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: JGE pc &lt;- </span><span class=si>{}</span><span class=s2> if [</span><span class=si>{}</span><span class=s2>] &gt;= [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span><span class=o>*</span><span class=mi>6</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_xor&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: XOR [</span><span class=si>{}</span><span class=s2>] &lt;- [</span><span class=si>{}</span><span class=s2>] ^ [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_store&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: STORE MEM[[</span><span class=si>{}</span><span class=s2>]] &lt;- [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_load&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: LOAD [</span><span class=si>{}</span><span class=s2>] &lt;- MEM[[</span><span class=si>{}</span><span class=s2>]]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>opr</span> <span class=o>==</span> <span class=s1>&#39;vm_input&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: INPUT [</span><span class=si>{}</span><span class=s2>]&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: UNKNOWN&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:03d}</span><span class=s2>: UNKNOWN </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>op</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./bin&#39;</span><span class=p>,</span><span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>ls1</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>ls2</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>f</span><span class=p>[</span><span class=mi>3</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls1</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>714</span><span class=p>,</span> <span class=mi>714</span> <span class=o>+</span> <span class=mi>220</span><span class=o>*</span><span class=mi>6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>ls1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>ls1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=mi>69</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>disass</span><span class=p>(</span><span class=n>ls1</span><span class=p>)</span>
</span></span></code></pre></div><p>Which gives the below output.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>000: PUTC &#39;[&#39;
</span></span><span class=line><span class=cl>006: PUTC &#39;M&#39;
</span></span><span class=line><span class=cl>012: PUTC &#39;a&#39;
</span></span><span class=line><span class=cl>018: PUTC &#39;i&#39;
</span></span><span class=line><span class=cl>024: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>030: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>036: PUTC &#39;V&#39;
</span></span><span class=line><span class=cl>042: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>048: PUTC &#39;s&#39;
</span></span><span class=line><span class=cl>054: PUTC &#39;s&#39;
</span></span><span class=line><span class=cl>060: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>066: PUTC &#39;l&#39;
</span></span><span class=line><span class=cl>072: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>078: PUTC &#39;T&#39;
</span></span><span class=line><span class=cl>084: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>090: PUTC &#39;r&#39;
</span></span><span class=line><span class=cl>096: PUTC &#39;m&#39;
</span></span><span class=line><span class=cl>102: PUTC &#39;i&#39;
</span></span><span class=line><span class=cl>108: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>114: PUTC &#39;a&#39;
</span></span><span class=line><span class=cl>120: PUTC &#39;l&#39;
</span></span><span class=line><span class=cl>126: PUTC &#39;]&#39;
</span></span><span class=line><span class=cl>132: PUTC &#39;\n&#39;
</span></span><span class=line><span class=cl>138: PUTC &#39;&lt;&#39;
</span></span><span class=line><span class=cl>144: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>150: PUTC &#39;E&#39;
</span></span><span class=line><span class=cl>156: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>162: PUTC &#39;t&#39;
</span></span><span class=line><span class=cl>168: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>174: PUTC &#39;r&#39;
</span></span><span class=line><span class=cl>180: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>186: PUTC &#39;k&#39;
</span></span><span class=line><span class=cl>192: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>198: PUTC &#39;y&#39;
</span></span><span class=line><span class=cl>204: PUTC &#39;c&#39;
</span></span><span class=line><span class=cl>210: PUTC &#39;o&#39;
</span></span><span class=line><span class=cl>216: PUTC &#39;d&#39;
</span></span><span class=line><span class=cl>222: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>228: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>234: PUTC &#39;\n&#39;
</span></span><span class=line><span class=cl>240: PUTC &#39;&gt;&#39;
</span></span><span class=line><span class=cl>246: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>252: MOV [30] &lt;- 160
</span></span><span class=line><span class=cl>258: MOV [28] &lt;- 0
</span></span><span class=line><span class=cl>264: MOV [29] &lt;- 17
</span></span><span class=line><span class=cl>270: INPUT [25]
</span></span><span class=line><span class=cl>276: STORE MEM[[30]] &lt;- [25]
</span></span><span class=line><span class=cl>282: ADDI [30] &lt;- [30] + 1
</span></span><span class=line><span class=cl>288: ADDI [28] &lt;- [28] + 1
</span></span><span class=line><span class=cl>294: JLE pc &lt;- 270 if [28] &lt;= [29]
</span></span><span class=line><span class=cl>300: MOV [30] &lt;- 4
</span></span><span class=line><span class=cl>306: MOV [31] &lt;- 160
</span></span><span class=line><span class=cl>312: MOV [28] &lt;- 0
</span></span><span class=line><span class=cl>318: MOV [29] &lt;- 10
</span></span><span class=line><span class=cl>324: MOV [27] &lt;- 169
</span></span><span class=line><span class=cl>330: MOV [23] &lt;- 0
</span></span><span class=line><span class=cl>336: LOAD [25] &lt;- MEM[[30]]
</span></span><span class=line><span class=cl>342: LOAD [24] &lt;- MEM[[31]]
</span></span><span class=line><span class=cl>348: XOR [25] &lt;- [25] ^ [27]
</span></span><span class=line><span class=cl>354: JE pc &lt;- 468 if [25] == [24]
</span></span><span class=line><span class=cl>360: PUTC &#39;U&#39;
</span></span><span class=line><span class=cl>366: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>372: PUTC &#39;k&#39;
</span></span><span class=line><span class=cl>378: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>384: PUTC &#39;o&#39;
</span></span><span class=line><span class=cl>390: PUTC &#39;w&#39;
</span></span><span class=line><span class=cl>396: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>402: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>408: PUTC &#39;k&#39;
</span></span><span class=line><span class=cl>414: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>420: PUTC &#39;y&#39;
</span></span><span class=line><span class=cl>426: PUTC &#39;c&#39;
</span></span><span class=line><span class=cl>432: PUTC &#39;o&#39;
</span></span><span class=line><span class=cl>438: PUTC &#39;d&#39;
</span></span><span class=line><span class=cl>444: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>450: PUTC &#39;!&#39;
</span></span><span class=line><span class=cl>456: PUTC &#39;\n&#39;
</span></span><span class=line><span class=cl>462: EXIT
</span></span><span class=line><span class=cl>468: ADDI [30] &lt;- [30] + 1
</span></span><span class=line><span class=cl>474: ADDI [31] &lt;- [31] + 1
</span></span><span class=line><span class=cl>480: ADDI [28] &lt;- [28] + 1
</span></span><span class=line><span class=cl>486: JLE pc &lt;- 336 if [28] &lt;= [29]
</span></span><span class=line><span class=cl>492: MOV [15] &lt;- 0
</span></span><span class=line><span class=cl>498: PUSH [15]
</span></span><span class=line><span class=cl>504: PUSH [15]
</span></span><span class=line><span class=cl>510: PUSH [15]
</span></span><span class=line><span class=cl>516: INV [31] &lt;- syscall(101, 3)
</span></span><span class=line><span class=cl>522: MOV [16] &lt;- 0
</span></span><span class=line><span class=cl>528: JE pc &lt;- 648 if [31] == [16]
</span></span><span class=line><span class=cl>534: PUTC &#39;T&#39;
</span></span><span class=line><span class=cl>540: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>546: PUTC &#39;r&#39;
</span></span><span class=line><span class=cl>552: PUTC &#39;m&#39;
</span></span><span class=line><span class=cl>558: PUTC &#39;i&#39;
</span></span><span class=line><span class=cl>564: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>570: PUTC &#39;a&#39;
</span></span><span class=line><span class=cl>576: PUTC &#39;l&#39;
</span></span><span class=line><span class=cl>582: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>588: PUTC &#39;b&#39;
</span></span><span class=line><span class=cl>594: PUTC &#39;l&#39;
</span></span><span class=line><span class=cl>600: PUTC &#39;o&#39;
</span></span><span class=line><span class=cl>606: PUTC &#39;c&#39;
</span></span><span class=line><span class=cl>612: PUTC &#39;k&#39;
</span></span><span class=line><span class=cl>618: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>624: PUTC &#39;d&#39;
</span></span><span class=line><span class=cl>630: PUTC &#39;!&#39;
</span></span><span class=line><span class=cl>636: PUTC &#39;\n&#39;
</span></span><span class=line><span class=cl>642: EXIT
</span></span><span class=line><span class=cl>648: MOV [30] &lt;- 119
</span></span><span class=line><span class=cl>654: MULI [30] &lt;- [30] * 6
</span></span><span class=line><span class=cl>660: MOV [28] &lt;- 0
</span></span><span class=line><span class=cl>666: MOV [29] &lt;- 220
</span></span><span class=line><span class=cl>672: MOV [27] &lt;- 69
</span></span><span class=line><span class=cl>678: LOAD [25] &lt;- MEM[[30]]
</span></span><span class=line><span class=cl>684: XOR [25] &lt;- [25] ^ [27]
</span></span><span class=line><span class=cl>690: STORE MEM[[30]] &lt;- [25]
</span></span><span class=line><span class=cl>696: ADDI [30] &lt;- [30] + 1
</span></span><span class=line><span class=cl>702: ADDI [28] &lt;- [28] + 1
</span></span><span class=line><span class=cl>708: JLE pc &lt;- 678 if [28] &lt;= [29]
</span></span><span class=line><span class=cl>714: PUTC &#39;&lt;&#39;
</span></span><span class=line><span class=cl>720: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>726: PUTC &#39;E&#39;
</span></span><span class=line><span class=cl>732: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>738: PUTC &#39;t&#39;
</span></span><span class=line><span class=cl>744: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>750: PUTC &#39;r&#39;
</span></span><span class=line><span class=cl>756: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>762: PUTC &#39;s&#39;
</span></span><span class=line><span class=cl>768: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>774: PUTC &#39;c&#39;
</span></span><span class=line><span class=cl>780: PUTC &#39;r&#39;
</span></span><span class=line><span class=cl>786: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>792: PUTC &#39;t&#39;
</span></span><span class=line><span class=cl>798: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>804: PUTC &#39;p&#39;
</span></span><span class=line><span class=cl>810: PUTC &#39;h&#39;
</span></span><span class=line><span class=cl>816: PUTC &#39;r&#39;
</span></span><span class=line><span class=cl>822: PUTC &#39;a&#39;
</span></span><span class=line><span class=cl>828: PUTC &#39;s&#39;
</span></span><span class=line><span class=cl>834: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>840: PUTC &#39;\n&#39;
</span></span><span class=line><span class=cl>846: PUTC &#39;&gt;&#39;
</span></span><span class=line><span class=cl>852: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>858: MOV [30] &lt;- 48
</span></span><span class=line><span class=cl>864: MOV [28] &lt;- 0
</span></span><span class=line><span class=cl>870: MOV [29] &lt;- 36
</span></span><span class=line><span class=cl>876: INPUT [25]
</span></span><span class=line><span class=cl>882: STORE MEM[[30]] &lt;- [25]
</span></span><span class=line><span class=cl>888: ADDI [30] &lt;- [30] + 1
</span></span><span class=line><span class=cl>894: ADDI [28] &lt;- [28] + 1
</span></span><span class=line><span class=cl>900: JLE pc &lt;- 876 if [28] &lt;= [29]
</span></span><span class=line><span class=cl>906: MOV [28] &lt;- 0
</span></span><span class=line><span class=cl>912: MOV [29] &lt;- 35
</span></span><span class=line><span class=cl>918: MOV [30] &lt;- 48
</span></span><span class=line><span class=cl>924: MOV [31] &lt;- 148
</span></span><span class=line><span class=cl>930: MOV [26] &lt;- 0
</span></span><span class=line><span class=cl>936: MOV [27] &lt;- 35
</span></span><span class=line><span class=cl>942: LOAD [20] &lt;- MEM[[30]]
</span></span><span class=line><span class=cl>948: LOAD [21] &lt;- MEM[[31]]
</span></span><span class=line><span class=cl>954: PUSH [20]
</span></span><span class=line><span class=cl>960: POP [19]
</span></span><span class=line><span class=cl>966: MOV [18] &lt;- 48
</span></span><span class=line><span class=cl>972: ADD [18] &lt;- [18] + [21]
</span></span><span class=line><span class=cl>978: LOAD [17] &lt;- MEM[[18]]
</span></span><span class=line><span class=cl>984: STORE MEM[[30]] &lt;- [17]
</span></span><span class=line><span class=cl>990: STORE MEM[[18]] &lt;- [19]
</span></span><span class=line><span class=cl>996: ADDI [26] &lt;- [26] + 1
</span></span><span class=line><span class=cl>1002: ADDI [30] &lt;- [30] + 1
</span></span><span class=line><span class=cl>1008: ADDI [31] &lt;- [31] + 1
</span></span><span class=line><span class=cl>1014: JLE pc &lt;- 942 if [26] &lt;= [27]
</span></span><span class=line><span class=cl>1020: MOV [30] &lt;- 48
</span></span><span class=line><span class=cl>1026: MOV [31] &lt;- 248
</span></span><span class=line><span class=cl>1032: MOV [26] &lt;- 0
</span></span><span class=line><span class=cl>1038: MOV [27] &lt;- 35
</span></span><span class=line><span class=cl>1044: LOAD [20] &lt;- MEM[[30]]
</span></span><span class=line><span class=cl>1050: PUSH [31]
</span></span><span class=line><span class=cl>1056: POP [15]
</span></span><span class=line><span class=cl>1062: ADD [15] &lt;- [15] + [28]
</span></span><span class=line><span class=cl>1068: LOAD [16] &lt;- MEM[[15]]
</span></span><span class=line><span class=cl>1074: XOR [20] &lt;- [20] ^ [16]
</span></span><span class=line><span class=cl>1080: STORE MEM[[30]] &lt;- [20]
</span></span><span class=line><span class=cl>1086: ADDI [26] &lt;- [26] + 1
</span></span><span class=line><span class=cl>1092: ADDI [30] &lt;- [30] + 1
</span></span><span class=line><span class=cl>1098: JLE pc &lt;- 1044 if [26] &lt;= [27]
</span></span><span class=line><span class=cl>1104: ADDI [28] &lt;- [28] + 1
</span></span><span class=line><span class=cl>1110: JLE pc &lt;- 918 if [28] &lt;= [29]
</span></span><span class=line><span class=cl>1116: MOV [30] &lt;- 48
</span></span><span class=line><span class=cl>1122: MOV [31] &lt;- 92
</span></span><span class=line><span class=cl>1128: MOV [26] &lt;- 0
</span></span><span class=line><span class=cl>1134: MOV [27] &lt;- 35
</span></span><span class=line><span class=cl>1140: LOAD [15] &lt;- MEM[[30]]
</span></span><span class=line><span class=cl>1146: LOAD [16] &lt;- MEM[[31]]
</span></span><span class=line><span class=cl>1152: JE pc &lt;- 1206 if [15] == [16]
</span></span><span class=line><span class=cl>1158: PUTC &#39;W&#39;
</span></span><span class=line><span class=cl>1164: PUTC &#39;r&#39;
</span></span><span class=line><span class=cl>1170: PUTC &#39;o&#39;
</span></span><span class=line><span class=cl>1176: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>1182: PUTC &#39;g&#39;
</span></span><span class=line><span class=cl>1188: PUTC &#39;!&#39;
</span></span><span class=line><span class=cl>1194: PUTC &#39;\n&#39;
</span></span><span class=line><span class=cl>1200: EXIT
</span></span><span class=line><span class=cl>1206: ADDI [26] &lt;- [26] + 1
</span></span><span class=line><span class=cl>1212: ADDI [30] &lt;- [30] + 1
</span></span><span class=line><span class=cl>1218: ADDI [31] &lt;- [31] + 1
</span></span><span class=line><span class=cl>1224: JLE pc &lt;- 1140 if [26] &lt;= [27]
</span></span><span class=line><span class=cl>1230: PUTC &#39;A&#39;
</span></span><span class=line><span class=cl>1236: PUTC &#39;c&#39;
</span></span><span class=line><span class=cl>1242: PUTC &#39;c&#39;
</span></span><span class=line><span class=cl>1248: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>1254: PUTC &#39;s&#39;
</span></span><span class=line><span class=cl>1260: PUTC &#39;s&#39;
</span></span><span class=line><span class=cl>1266: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>1272: PUTC &#39;g&#39;
</span></span><span class=line><span class=cl>1278: PUTC &#39;r&#39;
</span></span><span class=line><span class=cl>1284: PUTC &#39;a&#39;
</span></span><span class=line><span class=cl>1290: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>1296: PUTC &#39;t&#39;
</span></span><span class=line><span class=cl>1302: PUTC &#39;e&#39;
</span></span><span class=line><span class=cl>1308: PUTC &#39;d&#39;
</span></span><span class=line><span class=cl>1314: PUTC &#39;,&#39;
</span></span><span class=line><span class=cl>1320: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>1326: PUTC &#39;s&#39;
</span></span><span class=line><span class=cl>1332: PUTC &#39;h&#39;
</span></span><span class=line><span class=cl>1338: PUTC &#39;u&#39;
</span></span><span class=line><span class=cl>1344: PUTC &#39;t&#39;
</span></span><span class=line><span class=cl>1350: PUTC &#39;t&#39;
</span></span><span class=line><span class=cl>1356: PUTC &#39;i&#39;
</span></span><span class=line><span class=cl>1362: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>1368: PUTC &#39;g&#39;
</span></span><span class=line><span class=cl>1374: PUTC &#39; &#39;
</span></span><span class=line><span class=cl>1380: PUTC &#39;d&#39;
</span></span><span class=line><span class=cl>1386: PUTC &#39;o&#39;
</span></span><span class=line><span class=cl>1392: PUTC &#39;w&#39;
</span></span><span class=line><span class=cl>1398: PUTC &#39;n&#39;
</span></span><span class=line><span class=cl>1404: PUTC &#39;!&#39;
</span></span><span class=line><span class=cl>1410: PUTC &#39;\n&#39;
</span></span><span class=line><span class=cl>1416: EXIT
</span></span><span class=line><span class=cl>1422: UNKNOWN 69
</span></span></code></pre></div><p>For the part from <strong>714</strong> onwards, the text is being <strong>XOR-ed</strong> with key <strong>0x69</strong>.</p><p>Use debuggers to read the memory at <strong>[30]</strong> then <strong>XOR</strong> with key <strong>169</strong>, we get the first input, which is <strong>c0d3_r3d_5hutd0wn</strong>.</p><img src=re10.png alt=linux width=1000><p>Then we reach the part that it prints out <strong>Enter secret phrase</strong>. For this part, the algorithm is <strong>shuffle and XOR</strong>, which can be solved by using debuggers to read the memory at <strong>[92]</strong>, <strong>[148]</strong> and <strong>[248]</strong>, then by the Python script below, we get the flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>malduck</span> <span class=kn>import</span> <span class=n>unhex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key1</span> <span class=o>=</span> <span class=n>unhex</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;13190F0A07001D0E16100C010B1F181408091C1A21042212051B1120060215170D1E2303&#34;</span><span class=p>)</span>  <span class=c1>#[148]</span>
</span></span><span class=line><span class=cl><span class=n>key2</span> <span class=o>=</span> <span class=n>unhex</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;16B047B201FBDEEB825D5B5D107C6E215FE7452A3623D4D726D5A311EDE75ECBDB9FDDE2&#34;</span><span class=p>)</span>  <span class=c1>#[248]</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>unhex</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;655D774A3340566C75375D356E6E66366C367065776A31795D31707F6C6E33323636315D&#34;</span><span class=p>))</span>  <span class=c1>#[92]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>36</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>35</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>^</span> <span class=n>key2</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>35</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=n>k</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=n>key1</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span><span class=p>[</span><span class=n>key1</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>]))</span>
</span></span></code></pre></div><p>Flag is: <strong>HTB{5w1rl_4r0und_7h3_4l13n_l4ngu4g3}</strong></p><h2 id=somewhat-linear>Somewhat Linear</h2><ul><li><p><strong>Given zip:</strong> <a href="https://drive.google.com/drive/folders/1_ExekBgLRfE1J9aMB1QReaAHuX6_SHHZ?usp=share_link" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Category:</strong> Reverse Engineering</p></li><li><p><strong>Difficulty:</strong> Hard</p></li></ul><p>In this challenge, we are provided with <strong>input_generator.py</strong>, <strong>impulse_response.wav</strong>, and <strong>shuffled_flag.wav</strong> files. The objective is to reverse the process implemented in <strong>input_generator.py</strong> to recover the original flag message.</p><p>The <strong>input_generator.py</strong> script reads the flag from a file, applies a randomly generated filter to shuffle the frequencies, and then writes the shuffled flag and impulse response to two separate WAV files. The filtering process is achieved by multiplying the amplitudes of the flag&rsquo;s frequency components with the randomly generated <strong>filter_frequency_response</strong>.</p><p>To solve the challenge, we must deconvolute the shuffled flag by applying the inverse of the filter.</p><p>First, read the <strong>impulse_response.wav</strong> and <strong>shuffled_flag.wav</strong> files.</p><p>Next, calculate the filter&rsquo;s frequency response by taking the ratio of the Fast Fourier Transform (FFT) of shuffled_flag.wav to the FFT of impulse_response.wav.</p><p>Finally, apply the inverse of the filter to shuffled_flag.wav to recover the original flag.</p><p>However, the initial attempt to reverse the process yielded a low signal-to-noise ratio, making it difficult to hear the flag. To improve the result, a Wiener filter was implemented. The Wiener filter helps in deconvolution, extracting the original signal from the convoluted signal (in this case, the filter).</p><p>Here&rsquo;s the Python code to recover the flag using the Wiener filter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>soundfile</span> <span class=k>as</span> <span class=nn>sf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read impulse_response.wav and shuffled_flag.wav</span>
</span></span><span class=line><span class=cl><span class=n>impulse_response</span><span class=p>,</span> <span class=n>rate</span> <span class=o>=</span> <span class=n>sf</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s1>&#39;impulse_response.wav&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>shuffled_flag</span><span class=p>,</span> <span class=n>rate</span> <span class=o>=</span> <span class=n>sf</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s1>&#39;shuffled_flag.wav&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Compute the Wiener filter</span>
</span></span><span class=line><span class=cl><span class=n>impulse_response_fft</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>rfft</span><span class=p>(</span><span class=n>impulse_response</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>shuffled_flag_fft</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>rfft</span><span class=p>(</span><span class=n>shuffled_flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>wiener_filter</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>conj</span><span class=p>(</span><span class=n>impulse_response_fft</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>impulse_response_fft</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span> <span class=o>+</span> <span class=mf>1e-6</span><span class=p>)</span>  <span class=c1># Adding a small value to avoid division by zero</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Apply the Wiener filter to recover the original flag</span>
</span></span><span class=line><span class=cl><span class=n>recovered_flag_fft</span> <span class=o>=</span> <span class=n>wiener_filter</span> <span class=o>*</span> <span class=n>shuffled_flag_fft</span>
</span></span><span class=line><span class=cl><span class=n>recovered_flag</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>irfft</span><span class=p>(</span><span class=n>recovered_flag_fft</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the result to a WAV file</span>
</span></span><span class=line><span class=cl><span class=n>sf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;recovered_flag_using_wiener_filter.wav&#39;</span><span class=p>,</span> <span class=n>recovered_flag</span><span class=p>,</span> <span class=n>rate</span><span class=p>)</span>
</span></span></code></pre></div><p>After running the script, we can listen to the recovered_flag_using_wiener_filter.wav file to hear the flag.</p><p>Flag is: <strong>HTB{th1s_w@s_l0w_eff0rt}</strong></p><h2 id=analogue-signal-processing-v2>Analogue Signal Processing v2</h2><ul><li><p><strong>Given zip:</strong> <a href="https://drive.google.com/drive/folders/1HJWdy9Z56bPPIs0nPko2R1KUX7dCCUyj?usp=share_link" target=_blank rel=noopener>Get it here!</a></p></li><li><p><strong>Category:</strong> Reverse Engineering</p></li><li><p><strong>Difficulty:</strong> Insane</p></li></ul><p>In this challenge, the encoding process is implemented in <strong>input_generator.py</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>encode_flag</span><span class=p>(</span><span class=n>flag</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>vin</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>samples</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>flag</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>vout</span> <span class=o>=</span> <span class=n>simulate_chained_circuits</span><span class=p>([</span><span class=n>ZLCircuit</span><span class=p>(</span><span class=mi>1</span><span class=n>j</span> <span class=o>*</span> <span class=nb>ord</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> <span class=mi>1</span><span class=p>)],</span> <span class=n>vin</span><span class=p>,</span> <span class=n>duration</span><span class=p>,</span> <span class=n>SAMPLE_RATE</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>sf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;audio/encoded</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>.wav&#39;</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>real</span><span class=p>(</span><span class=n>vout</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;float64&#39;</span><span class=p>),</span> <span class=n>SAMPLE_RATE</span><span class=p>,</span> <span class=n>subtype</span><span class=o>=</span><span class=s1>&#39;DOUBLE&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>vin</span> <span class=o>=</span> <span class=n>vout</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;encoded </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1> of </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span><span class=si>}</span><span class=s1> characters&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>The <strong>encode_flag</strong> function takes the flag string as input and encodes it character by character. For each character, it creates a <strong>ZLCircuit</strong> object with a complex impedance of <strong>1j * ord(flag[i])</strong> and an inductance of <strong>1</strong> Henry. This circuit represents an inductor and a component with impedance Z in series.</p><p>The <strong>simulate_chained_circuits</strong> function from circuit.py is called with the created <strong>ZLCircuit</strong>, input signal <strong>vin</strong>, <strong>duration</strong>, and <strong>sample rate</strong> as arguments. This function calculates the state space representation of the circuits and uses it to simulate the response of the circuit to the input signal <strong>vin</strong>. The real part of the simulated output signal is saved as a WAV file with the filename format <strong>encoded{i}.wav</strong>.</p><p>The output signal vout is assigned as the input signal <strong>vin</strong> for the next iteration, as the circuits are chained, and the output of one circuit is used as the input for the next circuit. The encoding process results in a series of chained circuits with input signals that depend on the previous circuit&rsquo;s output. Our goal is to reverse this encoding process and extract the hidden flag characters from the provided audio files.</p><p>To decode the flag, we need to reverse the encoding process. Since the circuits are chained and the output of one circuit is used as the input for the next circuit, we can work our way backward from the last audio file to the first.</p><ol><li><p>Load the last audio file, <strong>encoded14.wav</strong>, as the initial input signal.</p></li><li><p>For each audio file, starting from the last and moving towards the first:</p><ul><li><p>Create a range of possible ASCII values for the flag&rsquo;s characters. Generally, the printable ASCII characters are between 32 and 126.</p></li><li><p>For each possible ASCII value:</p><ul><li><p>Create a <strong>ZLCircuit</strong> object with a complex impedance of <strong>1j * possible_ascii_value</strong> and an inductance of 1 Henry.</p></li><li><p>Call the <strong>simulate_chained_circuits</strong> function with the created <strong>ZLCircuit</strong>, the input signal from the audio file, duration, and sample rate as arguments.</p></li><li><p>Compare the simulated output signal with the input signal of the previous audio file (or a zero-filled array for the first character). Calculate the mean squared error (MSE) between the two signals.</p></li></ul></li><li><p>Find the character with the lowest MSE, which is the most likely decoded character for the current audio file.</p></li><li><p>Use the input signal of the current audio file as the input signal for the next iteration.</p></li></ul></li></ol><p>By iterating through the audio files in reverse order and finding the character with the lowest mean squared error between the simulated output signal and the input signal of the previous audio file, we can reconstruct the original flag. The decoded flag obtained is &ldquo;HTBqp)le_dance|&rdquo;.</p><p>However, this decoded flag is not entirely accurate. With some reasonable guesses, we can correct the flag. It is likely that the &ldquo;q&rdquo; and &ldquo;|&rdquo; characters should be replaced by &ldquo;{&rdquo; and &ldquo;}&rdquo;, respectively. Also, the &ldquo;)&rdquo; can be replaced by &ldquo;o&rdquo; or &ldquo;0&rdquo;. After these adjustments and some attempts, we get the correct flag: &ldquo;HTB{p0le_dance}&rdquo;.</p><p>Flag is: <strong>HTB{p0le_dance}</strong></p><h2 id=original-posts>Original Posts</h2><ul><li><a href=https://fazect.github.io/htb2023/ target=_blank rel=noopener>From FazeCT</a></li></ul></div><div class=article-tags><a class="badge badge-light" href=/tag/ctf/>ctf</a>
<a class="badge badge-light" href=/tag/writeup/>writeup</a>
<a class="badge badge-light" href=/tag/re/>re</a>
<a class="badge badge-light" href=/tag/htb-2023/>htb-2023</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-re%2F&text=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Reverse+Engineering" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-re%2F&t=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Reverse+Engineering" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Cyber%20Apocalypse%202023%3A%20The%20Cursed%20Mission%20-%20Reverse%20Engineering&body=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-re%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-re%2F&title=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Reverse+Engineering" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Reverse+Engineering%20https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-re%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fbkisc%2Fhtb2023-re%2F&title=Cyber+Apocalypse+2023%3A+The+Cursed+Mission+-+Reverse+Engineering" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=/author/fazect/><img class="avatar mr-3 avatar-circle" src=/author/fazect/avatar_hud20978e2ce79cef4f33eb5572feeafc8_109792_270x270_fill_lanczos_center_3.png alt=FazeCT></a><div class=media-body><h5 class=card-title><a href=/author/fazect/>FazeCT</a></h5><h6 class=card-subtitle>Reverser</h6><p class=card-text>Skill issue is one of my inner traits.</p><ul class=network-icon aria-hidden=true><li><a href=mailto:ctffazect@gmail.com><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/FazeCT target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://fazect.github.io/ target=_blank rel=noopener><i class="fas fa-globe"></i></a></li></ul></div></div><div class="media author-card content-widget-hr"><a href=/author/baodoktah/><img class="avatar mr-3 avatar-circle" src=/author/baodoktah/avatar_hu7c697624e6f76a4fa80194c4272ebb3e_1658076_270x270_fill_q75_lanczos_center.jpg alt=BaoDoktah></a><div class=media-body><h5 class=card-title><a href=/author/baodoktah/>BaoDoktah</a></h5><h6 class=card-subtitle>Reversing Engineer</h6><p class=card-text>Reverse Engineer at BKISC, dedicated to finding vulnerabilities and developing countermeasures to protect against cyber attacks.</p><ul class=network-icon aria-hidden=true><li><a href=mailto:kimgiabao3333@gmail.com><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/Baodokutah target=_blank rel=noopener><i class="fab fa-github"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text"> 2024 BK Information Security Club</p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a>  the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.fab8b449b814cc9f95b22fcf2e45f05b.js></script>
<script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.0c1be879804fa6ae06a8f4c131cdbf54.js></script>
<script src=/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script></body></html>